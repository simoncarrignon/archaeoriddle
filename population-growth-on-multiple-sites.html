<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Population growth on multiple sites | Methods Riddles, the ultimate revelations</title>
  <meta name="description" content="First draft of Rbookdown to describe how data have been generated" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Population growth on multiple sites | Methods Riddles, the ultimate revelations" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="First draft of Rbookdown to describe how data have been generated" />
  <meta name="github-repo" content="acortell3/archaeoriddle" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Population growth on multiple sites | Methods Riddles, the ultimate revelations" />
  
  <meta name="twitter:description" content="First draft of Rbookdown to describe how data have been generated" />
  

<meta name="author" content="CDAL" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="landscape-climate-environment.html"/>
<link rel="next" href="record-formation.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.11/grViz.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-is-archaeoriddle"><i class="fa fa-check"></i><b>1.1</b> What is archaeoriddle?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#what-will-you-find-in-this-bookdown"><i class="fa fa-check"></i><b>1.2</b> What will you find in this bookdown?</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#what-can-you-do-with-this"><i class="fa fa-check"></i><b>1.3</b> What can you do with this?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="landscape-climate-environment.html"><a href="landscape-climate-environment.html"><i class="fa fa-check"></i><b>2</b> Landscape, climate &amp; Environment</a>
<ul>
<li class="chapter" data-level="2.1" data-path="landscape-climate-environment.html"><a href="landscape-climate-environment.html#temperature-and-climate"><i class="fa fa-check"></i><b>2.1</b> Temperature and climate</a></li>
<li class="chapter" data-level="2.2" data-path="landscape-climate-environment.html"><a href="landscape-climate-environment.html#slope-and-elevation"><i class="fa fa-check"></i><b>2.2</b> Slope and Elevation</a></li>
<li class="chapter" data-level="2.3" data-path="landscape-climate-environment.html"><a href="landscape-climate-environment.html#settlements-position"><i class="fa fa-check"></i><b>2.3</b> Settlements position</a></li>
<li class="chapter" data-level="2.4" data-path="landscape-climate-environment.html"><a href="landscape-climate-environment.html#network-site-size-and-climate-deprecated"><i class="fa fa-check"></i><b>2.4</b> Network, Site Size And Climate – DEPRECATED</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="population-growth-on-multiple-sites.html"><a href="population-growth-on-multiple-sites.html"><i class="fa fa-check"></i><b>3</b> Population growth on multiple sites</a>
<ul>
<li class="chapter" data-level="3.1" data-path="population-growth-on-multiple-sites.html"><a href="population-growth-on-multiple-sites.html#environmental-resources"><i class="fa fa-check"></i><b>3.1</b> Environmental resources</a></li>
<li class="chapter" data-level="3.2" data-path="population-growth-on-multiple-sites.html"><a href="population-growth-on-multiple-sites.html#initializing-site-size-and-culture"><i class="fa fa-check"></i><b>3.2</b> Initializing Site Size and Culture:</a></li>
<li class="chapter" data-level="3.3" data-path="population-growth-on-multiple-sites.html"><a href="population-growth-on-multiple-sites.html#manual-selection"><i class="fa fa-check"></i><b>3.3</b> Manually Select Ressources</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="record-formation.html"><a href="record-formation.html"><i class="fa fa-check"></i><b>4</b> Record formation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="record-formation.html"><a href="record-formation.html#theoretical-model"><i class="fa fa-check"></i><b>4.1</b> Theoretical model</a></li>
<li class="chapter" data-level="4.2" data-path="record-formation.html"><a href="record-formation.html#implementation"><i class="fa fa-check"></i><b>4.2</b> Implementation</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="record-formation.html"><a href="record-formation.html#population-pop-protocol"><i class="fa fa-check"></i><b>4.2.1</b> Population <span class="math inline">\(Pop\)</span>-protocol</a></li>
<li class="chapter" data-level="4.2.2" data-path="record-formation.html"><a href="record-formation.html#anthropogenic-deposition-a-protocol"><i class="fa fa-check"></i><b>4.2.2</b> Anthropogenic deposition <span class="math inline">\(A\)</span>-protocol</a></li>
<li class="chapter" data-level="4.2.3" data-path="record-formation.html"><a href="record-formation.html#depth-d-protocol"><i class="fa fa-check"></i><b>4.2.3</b> Depth <span class="math inline">\(D\)</span>-protocol</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="record-formation.html"><a href="record-formation.html#example-and-simulation"><i class="fa fa-check"></i><b>4.3</b> Example and simulation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="record-loss.html"><a href="record-loss.html"><i class="fa fa-check"></i><b>5</b> Record loss</a>
<ul>
<li class="chapter" data-level="5.1" data-path="record-loss.html"><a href="record-loss.html#theoretical-model-1"><i class="fa fa-check"></i><b>5.1</b> Theoretical model</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="record-loss.html"><a href="record-loss.html#general-purpose"><i class="fa fa-check"></i><b>5.1.1</b> General purpose</a></li>
<li class="chapter" data-level="5.1.2" data-path="record-loss.html"><a href="record-loss.html#model-layers"><i class="fa fa-check"></i><b>5.1.2</b> Model layers</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="record-loss.html"><a href="record-loss.html#implementation-1"><i class="fa fa-check"></i><b>5.2</b> Implementation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="final-choice-and-simulation.html"><a href="final-choice-and-simulation.html"><i class="fa fa-check"></i><b>6</b> Final Choice and simulation</a></li>
<li class="chapter" data-level="7" data-path="generate-archaeological-remaind-and-squares.html"><a href="generate-archaeological-remaind-and-squares.html"><i class="fa fa-check"></i><b>7</b> Generate Archaeological remaind and squares</a>
<ul>
<li class="chapter" data-level="7.1" data-path="generate-archaeological-remaind-and-squares.html"><a href="generate-archaeological-remaind-and-squares.html#using-sites-size-to-generate-deposite"><i class="fa fa-check"></i><b>7.1</b> Using sites size to generate deposite</a></li>
<li class="chapter" data-level="7.2" data-path="generate-archaeological-remaind-and-squares.html"><a href="generate-archaeological-remaind-and-squares.html#split-environment-in-a-grid"><i class="fa fa-check"></i><b>7.2</b> Split environment in a grid</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/acortell3/archaeoriddle/">
source</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Methods Riddles, the ultimate revelations</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="population-growth-on-multiple-sites" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Population growth on multiple sites<a href="population-growth-on-multiple-sites.html#population-growth-on-multiple-sites" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Population will then grow, for years, and years. This implies multiple things: they need ressources, and we need to define a way for them to grow.</p>
<div id="environmental-resources" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Environmental resources<a href="population-growth-on-multiple-sites.html#environmental-resources" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will generate zones of high resources, that will attract settlements and support higher K.
The resources will be located at given hotspots with an area around in which they decay
with a logistic function. We provide a very basic function <code>logisticdecay</code> which allow to define multiple source with different decay array around them.</p>
<div class="r-help-page"><div class="container">

<table style="width: 100%;"><tr><td>logisticdecay</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2 id='logisticdecay'>Logistic decay</h2>

<h3>Description</h3>

<p>Given a raster and a vector of points, set resources hotspots with a
logistic decay around them
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logisticdecay(pt, rast, L = 1, k = 1e-04, x0 = 60000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logisticdecay_:_pt">pt</code></td>
<td>
<p>a vector points around witch decay is computed</p>
</td></tr>
<tr><td><code id="logisticdecay_:_rast">rast</code></td>
<td>
<p>a raster to compute distances</p>
</td></tr>
<tr><td><code id="logisticdecay_:_L">L</code></td>
<td>
<p>starting point of decay</p>
</td></tr>
<tr><td><code id="logisticdecay_:_k">k</code></td>
<td>
<p>a vector of decay rates</p>
</td></tr>
<tr><td><code id="logisticdecay_:_x0">x0</code></td>
<td>
<p>areas around <code>pt</code> in which resources decay from</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logistic decay vector
</p>


</div>
</div>
Here’s the code for the generation of resources under logistic decay
<details>
<summary>
Show code
</summary>
<p><strong>Code</strong></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="population-growth-on-multiple-sites.html#cb23-1" tabindex="-1"></a><span class="do">## Fucntion 13. Logistic decay for resource generation</span></span>
<span id="cb23-2"><a href="population-growth-on-multiple-sites.html#cb23-2" tabindex="-1"></a>logisticdecay <span class="ot">&lt;-</span> <span class="cf">function</span>(pt, rast, <span class="at">L=</span><span class="dv">1</span>, <span class="at">k=</span><span class="fl">0.0001</span>, <span class="at">x0=</span><span class="dv">60000</span>){</span>
<span id="cb23-3"><a href="population-growth-on-multiple-sites.html#cb23-3" tabindex="-1"></a>  ds <span class="ot">&lt;-</span> <span class="fu">distance</span>(rast, pt)</span>
<span id="cb23-4"><a href="population-growth-on-multiple-sites.html#cb23-4" tabindex="-1"></a>  logdec <span class="ot">=</span> L<span class="sc">-</span>L<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>k<span class="sc">*</span>(ds<span class="sc">-</span>x0)))</span>
<span id="cb23-5"><a href="population-growth-on-multiple-sites.html#cb23-5" tabindex="-1"></a>  <span class="fu">return</span>(logdec)</span>
<span id="cb23-6"><a href="population-growth-on-multiple-sites.html#cb23-6" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p><br></p>
<p>For the <em>archaeoriddle</em>, thes hotspots and there radius were manually selected given the topography. These manual setups are given below:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="population-growth-on-multiple-sites.html#cb24-1" tabindex="-1"></a><span class="do">##resource geolocalisation set manually</span></span>
<span id="cb24-2"><a href="population-growth-on-multiple-sites.html#cb24-2" tabindex="-1"></a>goodresources <span class="ot">&lt;-</span> <span class="fu">vect</span>(</span>
<span id="cb24-3"><a href="population-growth-on-multiple-sites.html#cb24-3" tabindex="-1"></a>  <span class="fu">cbind</span>(</span>
<span id="cb24-4"><a href="population-growth-on-multiple-sites.html#cb24-4" tabindex="-1"></a>    <span class="at">x=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2300711</span>, <span class="sc">-</span><span class="fl">3.1455282</span>, <span class="sc">-</span><span class="fl">0.5086485</span>, <span class="sc">-</span><span class="fl">1.9639755</span>,</span>
<span id="cb24-5"><a href="population-growth-on-multiple-sites.html#cb24-5" tabindex="-1"></a>        <span class="sc">-</span><span class="fl">0.4077843</span>, <span class="fl">0.019688</span>, <span class="sc">-</span><span class="fl">3.116710</span>),</span>
<span id="cb24-6"><a href="population-growth-on-multiple-sites.html#cb24-6" tabindex="-1"></a>    <span class="at">y=</span><span class="fu">c</span>(<span class="fl">3.6423000</span>, <span class="sc">-</span><span class="fl">0.2551019</span>, <span class="sc">-</span><span class="fl">0.7440748</span>, <span class="fl">1.1303214</span>,</span>
<span id="cb24-7"><a href="population-growth-on-multiple-sites.html#cb24-7" tabindex="-1"></a>        <span class="fl">1.0248567</span>, <span class="fl">0.2194895</span>, <span class="fl">2.0267718</span>)</span>
<span id="cb24-8"><a href="population-growth-on-multiple-sites.html#cb24-8" tabindex="-1"></a>  )</span>
<span id="cb24-9"><a href="population-growth-on-multiple-sites.html#cb24-9" tabindex="-1"></a>)</span>
<span id="cb24-10"><a href="population-growth-on-multiple-sites.html#cb24-10" tabindex="-1"></a><span class="co">#spread of resources</span></span>
<span id="cb24-11"><a href="population-growth-on-multiple-sites.html#cb24-11" tabindex="-1"></a>areas <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">*</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">2000</span>, <span class="dv">200</span>, <span class="dv">300</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">400</span>)</span>
<span id="cb24-12"><a href="population-growth-on-multiple-sites.html#cb24-12" tabindex="-1"></a><span class="co">#speed of ressource decay:</span></span>
<span id="cb24-13"><a href="population-growth-on-multiple-sites.html#cb24-13" tabindex="-1"></a>ks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.0002</span>, <span class="fl">0.0001000</span>, <span class="fl">0.0001600</span>, <span class="fl">0.0001800</span>, <span class="fl">0.00040</span>, .<span class="dv">0002</span>, <span class="fl">0.0002</span>)<span class="sc">/</span><span class="dv">4</span></span>
<span id="cb24-14"><a href="population-growth-on-multiple-sites.html#cb24-14" tabindex="-1"></a></span>
<span id="cb24-15"><a href="population-growth-on-multiple-sites.html#cb24-15" tabindex="-1"></a></span>
<span id="cb24-16"><a href="population-growth-on-multiple-sites.html#cb24-16" tabindex="-1"></a><span class="fu">crs</span>(goodresources) <span class="ot">&lt;-</span> <span class="fu">crs</span>(original.ras)</span></code></pre></div>
<p>The function <code>logisticdecay</code> generates individual rasters for all the identified hotspots, which are then merged to create an aggregate raster referred to as ‘resources’.</p>
<p>When considering the selection of hotspots, one may choose to retain the one utilized for the <em>archaeoriddle</em>, although its center may be positioned in water based on the preceding generation outcome. Choosing them manual remains the best option, one can use <code>locator()</code> to find the coordinates of the hotspot by click on the raster, an example of that is given at <a href="population-growth-on-multiple-sites.html#manual-selection">the end of this chapter</a></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="population-growth-on-multiple-sites.html#cb25-1" tabindex="-1"></a></span>
<span id="cb25-2"><a href="population-growth-on-multiple-sites.html#cb25-2" tabindex="-1"></a>allres <span class="ot">&lt;-</span> <span class="fu">lapply</span>(</span>
<span id="cb25-3"><a href="population-growth-on-multiple-sites.html#cb25-3" tabindex="-1"></a>  <span class="fu">seq_along</span>(goodresources),</span>
<span id="cb25-4"><a href="population-growth-on-multiple-sites.html#cb25-4" tabindex="-1"></a>  <span class="cf">function</span>(i){</span>
<span id="cb25-5"><a href="population-growth-on-multiple-sites.html#cb25-5" tabindex="-1"></a>    <span class="fu">logisticdecay</span>(goodresources[i], <span class="fu">mask</span>(height.ras, viable),</span>
<span id="cb25-6"><a href="population-growth-on-multiple-sites.html#cb25-6" tabindex="-1"></a>                  <span class="at">x=</span>areas[i], <span class="at">k=</span>ks[i]</span>
<span id="cb25-7"><a href="population-growth-on-multiple-sites.html#cb25-7" tabindex="-1"></a>    )</span>
<span id="cb25-8"><a href="population-growth-on-multiple-sites.html#cb25-8" tabindex="-1"></a>  }</span>
<span id="cb25-9"><a href="population-growth-on-multiple-sites.html#cb25-9" tabindex="-1"></a>)</span>
<span id="cb25-10"><a href="population-growth-on-multiple-sites.html#cb25-10" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          </span></span>
<span id="cb25-11"><a href="population-growth-on-multiple-sites.html#cb25-11" tabindex="-1"></a></span>
<span id="cb25-12"><a href="population-growth-on-multiple-sites.html#cb25-12" tabindex="-1"></a>allna <span class="ot">&lt;-</span> <span class="fu">sapply</span>(allres, <span class="cf">function</span>(i)<span class="fu">any</span>(<span class="fu">is.na</span>(<span class="fu">values</span>(i))))</span>
<span id="cb25-13"><a href="population-growth-on-multiple-sites.html#cb25-13" tabindex="-1"></a>allres <span class="ot">&lt;-</span> allres[<span class="sc">!</span>allna]</span>
<span id="cb25-14"><a href="population-growth-on-multiple-sites.html#cb25-14" tabindex="-1"></a></span>
<span id="cb25-15"><a href="population-growth-on-multiple-sites.html#cb25-15" tabindex="-1"></a>ress <span class="ot">&lt;-</span> allres[[<span class="dv">1</span>]]</span>
<span id="cb25-16"><a href="population-growth-on-multiple-sites.html#cb25-16" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(allres))</span>
<span id="cb25-17"><a href="population-growth-on-multiple-sites.html#cb25-17" tabindex="-1"></a>    ress <span class="ot">&lt;-</span> ress <span class="sc">+</span> allres[[i]]</span>
<span id="cb25-18"><a href="population-growth-on-multiple-sites.html#cb25-18" tabindex="-1"></a>ress <span class="ot">&lt;-</span> <span class="fu">mask</span>(ress,viable)</span>
<span id="cb25-19"><a href="population-growth-on-multiple-sites.html#cb25-19" tabindex="-1"></a><span class="fu">plot</span>(ress)</span></code></pre></div>
<p><img src="_main_files/figure-html/groupresources-1.png" width="672" /></p>
<p>This is also something that will be share with participants and thus will be saved in the folder with the DEM and the coastline.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="population-growth-on-multiple-sites.html#cb26-1" tabindex="-1"></a><span class="fu">writeRaster</span>(<span class="at">filename=</span><span class="fu">file.path</span>(foldname,<span class="st">&quot;resources.tiff&quot;</span>), ress, <span class="at">overwrite=</span>T) <span class="co">#write the resources as a raster</span></span></code></pre></div>
</div>
<div id="initializing-site-size-and-culture" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Initializing Site Size and Culture:<a href="population-growth-on-multiple-sites.html#initializing-site-size-and-culture" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We now have resources available to help us determine the size of each site. For each site, we will designate them as either belonging to the hunter-gather (HG) or farmer (F) culture .</p>
<p>Initially, all sites will be designated as hunter-gatherer sites, except for the one located in the most southwest position. Please note that this decision was based on specific shape of the initial archaeoriddle’s challenge. If needed, you may manually select the site culture for this specific location.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="population-growth-on-multiple-sites.html#cb27-1" tabindex="-1"></a>cultures <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;HG&quot;</span>,<span class="fu">length</span>(sites))</span>
<span id="cb27-2"><a href="population-growth-on-multiple-sites.html#cb27-2" tabindex="-1"></a>sw <span class="ot">&lt;-</span> <span class="fu">which.min</span>(<span class="fu">sqrt</span>((<span class="fu">crds</span>(sites)[,<span class="st">&quot;x&quot;</span>] <span class="sc">-</span> <span class="fu">min</span>(<span class="fu">crds</span>(sites)[,<span class="st">&quot;x&quot;</span>]))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (<span class="fu">crds</span>(sites)[,<span class="st">&quot;y&quot;</span>] <span class="sc">-</span> <span class="fu">min</span>(<span class="fu">crds</span>(sites)[,<span class="st">&quot;y&quot;</span>]))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb27-3"><a href="population-growth-on-multiple-sites.html#cb27-3" tabindex="-1"></a>cultures[sw]<span class="ot">=</span><span class="st">&quot;F&quot;</span></span>
<span id="cb27-4"><a href="population-growth-on-multiple-sites.html#cb27-4" tabindex="-1"></a>sites<span class="sc">$</span>culture <span class="ot">&lt;-</span> cultures</span>
<span id="cb27-5"><a href="population-growth-on-multiple-sites.html#cb27-5" tabindex="-1"></a></span>
<span id="cb27-6"><a href="population-growth-on-multiple-sites.html#cb27-6" tabindex="-1"></a><span class="fu">plotMap</span>(height.ras,height.wat)</span>
<span id="cb27-7"><a href="population-growth-on-multiple-sites.html#cb27-7" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">crds</span>(sites),<span class="at">bg=</span><span class="fu">as.factor</span>(cultures),<span class="at">pch=</span><span class="dv">21</span>,<span class="at">cex=</span><span class="fl">1.3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/setcultures-1.png" width="672" /></p>
<p>The each site will then be assigned a carrying capacity (how many people can leave on the site), defined using the ressource raster and the culture.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="population-growth-on-multiple-sites.html#cb28-1" tabindex="-1"></a></span>
<span id="cb28-2"><a href="population-growth-on-multiple-sites.html#cb28-2" tabindex="-1"></a>Kbase <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="dv">45</span>,<span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="dv">120</span>) <span class="co">#difference in base-K for the two cultures</span></span>
<span id="cb28-3"><a href="population-growth-on-multiple-sites.html#cb28-3" tabindex="-1"></a></span>
<span id="cb28-4"><a href="population-growth-on-multiple-sites.html#cb28-4" tabindex="-1"></a><span class="co"># The base Ks  are then modulated given the ressource raster</span></span>
<span id="cb28-5"><a href="population-growth-on-multiple-sites.html#cb28-5" tabindex="-1"></a>sites<span class="sc">$</span>Ks <span class="ot">&lt;-</span> <span class="fu">initKs</span>(Kbase, sites, ress, <span class="at">sizeexp=</span><span class="st">&quot;F&quot;</span>)</span></code></pre></div>
<p>Using these carrying capacities, we then set initial number of people, and the population structure for each sites:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="population-growth-on-multiple-sites.html#cb29-1" tabindex="-1"></a><span class="co"># Optionally we can intialize here our list of sites and population structures</span></span>
<span id="cb29-2"><a href="population-growth-on-multiple-sites.html#cb29-2" tabindex="-1"></a><span class="co"># Otherwise, they are initialized within the run_simulation function</span></span>
<span id="cb29-3"><a href="population-growth-on-multiple-sites.html#cb29-3" tabindex="-1"></a><span class="co"># Population size at initialisation, a number close to Ks</span></span>
<span id="cb29-4"><a href="population-growth-on-multiple-sites.html#cb29-4" tabindex="-1"></a>INs <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="fu">length</span>(sites), <span class="fl">0.85</span>, <span class="fl">0.95</span>)<span class="sc">*</span>sites<span class="sc">$</span>Ks)</span>
<span id="cb29-5"><a href="population-growth-on-multiple-sites.html#cb29-5" tabindex="-1"></a></span>
<span id="cb29-6"><a href="population-growth-on-multiple-sites.html#cb29-6" tabindex="-1"></a><span class="co"># initialise population structure for all sites</span></span>
<span id="cb29-7"><a href="population-growth-on-multiple-sites.html#cb29-7" tabindex="-1"></a>Ips <span class="ot">&lt;-</span> <span class="fu">lapply</span>(INs, initpopstruc)</span>
<span id="cb29-8"><a href="population-growth-on-multiple-sites.html#cb29-8" tabindex="-1"></a></span>
<span id="cb29-9"><a href="population-growth-on-multiple-sites.html#cb29-9" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="dv">150</span></span>
<span id="cb29-10"><a href="population-growth-on-multiple-sites.html#cb29-10" tabindex="-1"></a></span>
<span id="cb29-11"><a href="population-growth-on-multiple-sites.html#cb29-11" tabindex="-1"></a><span class="co"># We put the population structure across the years in a matrix: each row will represent a time step of the simulation ; each column a sites</span></span>
<span id="cb29-12"><a href="population-growth-on-multiple-sites.html#cb29-12" tabindex="-1"></a></span>
<span id="cb29-13"><a href="population-growth-on-multiple-sites.html#cb29-13" tabindex="-1"></a>Nts <span class="ot">&lt;-</span> <span class="fu">initlistsites</span>(Ips, <span class="at">ts=</span>ts)</span></code></pre></div>
<p>We can look at the population structure of the biggest site:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="population-growth-on-multiple-sites.html#cb30-1" tabindex="-1"></a>biggest <span class="ot">&lt;-</span> <span class="fu">which.max</span>(INs)</span>
<span id="cb30-2"><a href="population-growth-on-multiple-sites.html#cb30-2" tabindex="-1"></a>pop.biggest <span class="ot">&lt;-</span> Ips[[biggest]]</span>
<span id="cb30-3"><a href="population-growth-on-multiple-sites.html#cb30-3" tabindex="-1"></a>poplist<span class="ot">=</span><span class="fu">sapply</span>(<span class="fu">c</span>(<span class="at">F=</span><span class="st">&quot;F&quot;</span>,<span class="at">M=</span><span class="st">&quot;M&quot;</span>),<span class="cf">function</span>(s)<span class="fu">table</span>(<span class="fu">cut</span>(pop.biggest[pop.biggest[,<span class="dv">2</span>]<span class="sc">==</span>s,<span class="dv">1</span>],<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">40</span>,<span class="dv">4</span>))))</span>
<span id="cb30-4"><a href="population-growth-on-multiple-sites.html#cb30-4" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb30-5"><a href="population-growth-on-multiple-sites.html#cb30-5" tabindex="-1"></a><span class="fu">barplot</span>(<span class="sc">-</span>poplist[,<span class="dv">1</span>],<span class="at">beside=</span>T,<span class="at">horiz=</span>T,<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>),<span class="at">axes=</span>F,<span class="at">las=</span><span class="dv">1</span>)</span>
<span id="cb30-6"><a href="population-growth-on-multiple-sites.html#cb30-6" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">10</span>))</span>
<span id="cb30-7"><a href="population-growth-on-multiple-sites.html#cb30-7" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">unname</span>(poplist[,<span class="dv">1</span>]),<span class="at">beside=</span>T,<span class="at">horiz=</span>T,<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>),<span class="at">axes=</span>F)</span></code></pre></div>
<p><img src="_main_files/figure-html/agestruc-1.png" width="40%" /><img src="_main_files/figure-html/agestruc-2.png" width="40%" /></p>
You can see the code of <code>initKs</code>, <code>initpopstruct</code> and <code>initlistsites</code> functions here:
<details>
<summary>
Show code
</summary>
<p><strong>Code</strong></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="population-growth-on-multiple-sites.html#cb31-1" tabindex="-1"></a><span class="do">## Function 14. Initial carrying capacity</span></span>
<span id="cb31-2"><a href="population-growth-on-multiple-sites.html#cb31-2" tabindex="-1"></a>initKs <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">Kbase=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="dv">30</span>,<span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="dv">120</span>), sites, ressources,</span>
<span id="cb31-3"><a href="population-growth-on-multiple-sites.html#cb31-3" tabindex="-1"></a>                   <span class="at">sizeexp=</span><span class="cn">NULL</span>, <span class="at">rate=</span>.<span class="dv">5</span>){</span>
<span id="cb31-4"><a href="population-growth-on-multiple-sites.html#cb31-4" tabindex="-1"></a>  Ks <span class="ot">&lt;-</span> <span class="fu">round</span>(Kbase[sites<span class="sc">$</span>culture] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(sites), <span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb31-5"><a href="population-growth-on-multiple-sites.html#cb31-5" tabindex="-1"></a>  <span class="cf">while</span>(<span class="fu">any</span>(Ks<span class="sc">&lt;</span><span class="dv">1</span>)){</span>
<span id="cb31-6"><a href="population-growth-on-multiple-sites.html#cb31-6" tabindex="-1"></a>    Ks <span class="ot">&lt;-</span> <span class="fu">round</span>( Kbase[sites<span class="sc">$</span>culture] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(sites), <span class="dv">0</span>, <span class="dv">10</span>) )</span>
<span id="cb31-7"><a href="population-growth-on-multiple-sites.html#cb31-7" tabindex="-1"></a>  }</span>
<span id="cb31-8"><a href="population-growth-on-multiple-sites.html#cb31-8" tabindex="-1"></a>  <span class="co">#Ks[sites$culture==&quot;F&quot;]=Ks[sites$culture==&quot;F&quot;]*runif(sum(sites$culture==&quot;F&quot;),1,1)</span></span>
<span id="cb31-9"><a href="population-growth-on-multiple-sites.html#cb31-9" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> Ks <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">extract</span>(ressources, sites)[, <span class="dv">2</span>])</span>
<span id="cb31-10"><a href="population-growth-on-multiple-sites.html#cb31-10" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(sizeexp)){</span>
<span id="cb31-11"><a href="population-growth-on-multiple-sites.html#cb31-11" tabindex="-1"></a>    tmp[sites<span class="sc">$</span>culture<span class="sc">==</span>sizeexp] <span class="ot">&lt;-</span> (</span>
<span id="cb31-12"><a href="population-growth-on-multiple-sites.html#cb31-12" tabindex="-1"></a>      (Ks[sites<span class="sc">$</span>culture<span class="sc">==</span>sizeexp]) <span class="sc">*</span></span>
<span id="cb31-13"><a href="population-growth-on-multiple-sites.html#cb31-13" tabindex="-1"></a>        (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">rexp</span>(<span class="fu">sum</span>(sites<span class="sc">$</span>culture<span class="sc">==</span>sizeexp), <span class="at">rate=</span>rate) <span class="sc">*</span> <span class="fu">extract</span>(ressources, sites[sites<span class="sc">$</span>culture<span class="sc">==</span>sizeexp])[,<span class="dv">2</span>])</span>
<span id="cb31-14"><a href="population-growth-on-multiple-sites.html#cb31-14" tabindex="-1"></a>    )</span>
<span id="cb31-15"><a href="population-growth-on-multiple-sites.html#cb31-15" tabindex="-1"></a>  }</span>
<span id="cb31-16"><a href="population-growth-on-multiple-sites.html#cb31-16" tabindex="-1"></a>  tmp</span>
<span id="cb31-17"><a href="population-growth-on-multiple-sites.html#cb31-17" tabindex="-1"></a>}</span>
<span id="cb31-18"><a href="population-growth-on-multiple-sites.html#cb31-18" tabindex="-1"></a></span>
<span id="cb31-19"><a href="population-growth-on-multiple-sites.html#cb31-19" tabindex="-1"></a></span>
<span id="cb31-20"><a href="population-growth-on-multiple-sites.html#cb31-20" tabindex="-1"></a> </span>
<span id="cb31-21"><a href="population-growth-on-multiple-sites.html#cb31-21" tabindex="-1"></a><span class="do">## Function 15. Create population matrix</span></span>
<span id="cb31-22"><a href="population-growth-on-multiple-sites.html#cb31-22" tabindex="-1"></a>initpopstruc <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n=</span><span class="dv">100</span>, <span class="at">ages=</span><span class="dv">10</span><span class="sc">:</span><span class="dv">30</span>, <span class="at">p_sex=</span><span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>)){</span>
<span id="cb31-23"><a href="population-growth-on-multiple-sites.html#cb31-23" tabindex="-1"></a>  initpop <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb31-24"><a href="population-growth-on-multiple-sites.html#cb31-24" tabindex="-1"></a>    <span class="st">&quot;Age&quot;</span> <span class="ot">=</span> <span class="fu">sample</span>(ages, n, ages, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-25"><a href="population-growth-on-multiple-sites.html#cb31-25" tabindex="-1"></a>    <span class="st">&quot;Sex&quot;</span> <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>), n, <span class="at">prob =</span> p_sex, <span class="at">replace =</span> <span class="cn">TRUE</span>))   </span>
<span id="cb31-26"><a href="population-growth-on-multiple-sites.html#cb31-26" tabindex="-1"></a>  <span class="fu">return</span>(initpop)</span>
<span id="cb31-27"><a href="population-growth-on-multiple-sites.html#cb31-27" tabindex="-1"></a>}</span>
<span id="cb31-28"><a href="population-growth-on-multiple-sites.html#cb31-28" tabindex="-1"></a></span>
<span id="cb31-29"><a href="population-growth-on-multiple-sites.html#cb31-29" tabindex="-1"></a></span>
<span id="cb31-30"><a href="population-growth-on-multiple-sites.html#cb31-30" tabindex="-1"></a><span class="do">## Function 16. Initialize initial list of sites</span></span>
<span id="cb31-31"><a href="population-growth-on-multiple-sites.html#cb31-31" tabindex="-1"></a>initlistsites <span class="ot">&lt;-</span> <span class="cf">function</span>(list_sites, <span class="at">ts=</span><span class="dv">200</span>){</span>
<span id="cb31-32"><a href="population-growth-on-multiple-sites.html#cb31-32" tabindex="-1"></a>  Nts <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>ts<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(list_sites))</span>
<span id="cb31-33"><a href="population-growth-on-multiple-sites.html#cb31-33" tabindex="-1"></a>  Nts[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(list_sites, nrow)</span>
<span id="cb31-34"><a href="population-growth-on-multiple-sites.html#cb31-34" tabindex="-1"></a>  <span class="fu">return</span>(Nts)</span>
<span id="cb31-35"><a href="population-growth-on-multiple-sites.html#cb31-35" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>We now have sites with two cultures. The grow of the sites will depend on a lot of paparemeters; which are all a bit different depending on the two cultures. The list of parameters used is deined below:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="population-growth-on-multiple-sites.html#cb32-1" tabindex="-1"></a></span>
<span id="cb32-2"><a href="population-growth-on-multiple-sites.html#cb32-2" tabindex="-1"></a><span class="co">#initialisation</span></span>
<span id="cb32-3"><a href="population-growth-on-multiple-sites.html#cb32-3" tabindex="-1"></a></span>
<span id="cb32-4"><a href="population-growth-on-multiple-sites.html#cb32-4" tabindex="-1"></a>Kbase<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="dv">45</span>,<span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="dv">120</span>) <span class="co">#difference in K for the two cultures use and defined before ; will be use in simulation to define new site</span></span>
<span id="cb32-5"><a href="population-growth-on-multiple-sites.html#cb32-5" tabindex="-1"></a></span>
<span id="cb32-6"><a href="population-growth-on-multiple-sites.html#cb32-6" tabindex="-1"></a><span class="co"># spatial penality for cultural extentions, ie for population to move out of initial site : lower, bigger penality</span></span>
<span id="cb32-7"><a href="population-growth-on-multiple-sites.html#cb32-7" tabindex="-1"></a>cul_ext <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="dv">7</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="dv">6</span>)</span>
<span id="cb32-8"><a href="population-growth-on-multiple-sites.html#cb32-8" tabindex="-1"></a></span>
<span id="cb32-9"><a href="population-growth-on-multiple-sites.html#cb32-9" tabindex="-1"></a><span class="co"># penality of occupational area ie how hard it is to come close to your site ; if low, other sites can come close</span></span>
<span id="cb32-10"><a href="population-growth-on-multiple-sites.html#cb32-10" tabindex="-1"></a>penal_cul <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="dv">4</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="dv">5</span>)</span>
<span id="cb32-11"><a href="population-growth-on-multiple-sites.html#cb32-11" tabindex="-1"></a><span class="co"># proba to give birth every year</span></span>
<span id="cb32-12"><a href="population-growth-on-multiple-sites.html#cb32-12" tabindex="-1"></a>prob_birth <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="fl">0.3</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.5</span>)</span>
<span id="cb32-13"><a href="population-growth-on-multiple-sites.html#cb32-13" tabindex="-1"></a><span class="co"># proba to die when pop &gt; K</span></span>
<span id="cb32-14"><a href="population-growth-on-multiple-sites.html#cb32-14" tabindex="-1"></a>prob_survive <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="fl">0.8</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.6</span>)</span>
<span id="cb32-15"><a href="population-growth-on-multiple-sites.html#cb32-15" tabindex="-1"></a><span class="co"># proba to create new settlement when Ne &gt; K</span></span>
<span id="cb32-16"><a href="population-growth-on-multiple-sites.html#cb32-16" tabindex="-1"></a>prob_split <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="fl">0.2</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.6</span>)</span>
<span id="cb32-17"><a href="population-growth-on-multiple-sites.html#cb32-17" tabindex="-1"></a><span class="co"># how big the group of migrant should be to create a new city vs</span></span>
<span id="cb32-18"><a href="population-growth-on-multiple-sites.html#cb32-18" tabindex="-1"></a><span class="co"># migrate to a existing one</span></span>
<span id="cb32-19"><a href="population-growth-on-multiple-sites.html#cb32-19" tabindex="-1"></a>minimals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="fl">0.14</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.20</span>)</span>
<span id="cb32-20"><a href="population-growth-on-multiple-sites.html#cb32-20" tabindex="-1"></a><span class="co"># prob to migrate to existing settlement when Ne &gt; K</span></span>
<span id="cb32-21"><a href="population-growth-on-multiple-sites.html#cb32-21" tabindex="-1"></a>prob_move <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="fl">0.2</span>,<span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.1</span>)</span></code></pre></div>
<p>Let’s see our raster map again, and put the sites on top, with their ids and showing there initial population size:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="population-growth-on-multiple-sites.html#cb33-1" tabindex="-1"></a><span class="fu">plotMap</span>(height.ras,height.wat,<span class="fu">paste0</span>(<span class="st">&quot;year &quot;</span>, <span class="dv">0</span>))</span>
<span id="cb33-2"><a href="population-growth-on-multiple-sites.html#cb33-2" tabindex="-1"></a><span class="fu">plot</span>(sites, <span class="at">pch=</span><span class="dv">21</span>, <span class="at">add=</span>T, <span class="at">bg=</span><span class="fu">rainbow</span>(<span class="dv">2</span>, <span class="at">alpha=</span><span class="fl">0.6</span>)[<span class="fu">as.factor</span>(sites<span class="sc">$</span>culture)],<span class="at">cex=</span>(<span class="dv">1</span><span class="sc">+</span>Nts[<span class="dv">1</span>,]<span class="sc">/</span><span class="dv">100</span>))</span>
<span id="cb33-3"><a href="population-growth-on-multiple-sites.html#cb33-3" tabindex="-1"></a><span class="fu">text</span>(sites,<span class="at">pos=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>The <code>run_simulation</code> function will take the raster data and parameters for defined before for the two different cultures and run for the specified number of years <code>ts</code> (150).</p>
<p><br></p>
<div class="r-help-page"><div class="container">

<table style="width: 100%;"><tr><td>run_simulation</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2 id='run_simulation'>Run simulation</h2>

<h3>Description</h3>

<p>This function runs a stochastic simulation in which different cultures
positioned in sites in a raster interact, grow, die, fight, migrate,...
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_simulation(
  cultures = NULL,
  viable = viable,
  sites = sites,
  dem = height.ras,
  ressources = ress,
  water = height.wat,
  foldervid = "pathtofinal",
  visu = FALSE,
  visumin = TRUE,
  ts = 20000,
  Kbase = c(HG = 35, F = 120),
  cul_ext = c(HG = 7, F = 6),
  penal_cul = c(HG = 4, F = 5),
  prob_birth = c(HG = 0.3, F = 0.5),
  prob_survive = c(HG = 0.8, F = 0.6),
  prob_split = c(HG = 0.2, F = 0.6),
  prob_move = c(HG = 0.2, F = 0.1),
  minimals = c(HG = 0.14, F = 0.2),
  bufferatack = 400,
  buffersettl = 2000,
  Nts = NULL,
  Ips = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="run_simulation_:_cultures">cultures</code></td>
<td>
<p>Vector of cultures to be simulated. Default is <code>NULL</code>,
in which case it is taken from <code>sites</code>. Culture names must also be present in
as names in the named vectors with the simulation parameters for each culture.</p>
</td></tr>
<tr><td><code id="run_simulation_:_viable">viable</code></td>
<td>
<p>Viable SpatVector of the territory</p>
</td></tr>
<tr><td><code id="run_simulation_:_sites">sites</code></td>
<td>
<p>SpatVector of sites</p>
</td></tr>
<tr><td><code id="run_simulation_:_dem">dem</code></td>
<td>
<p>Digital Elevation Model SpatRaster of the map</p>
</td></tr>
<tr><td><code id="run_simulation_:_ressources">ressources</code></td>
<td>
<p>SpatVector with resources position</p>
</td></tr>
<tr><td><code id="run_simulation_:_water">water</code></td>
<td>
<p>SpatRaster with water</p>
</td></tr>
<tr><td><code id="run_simulation_:_foldervid">foldervid</code></td>
<td>
<p>If <code>visu=TRUE</code>, folder to save plots with simulation snaps</p>
</td></tr>
<tr><td><code id="run_simulation_:_visu">visu</code></td>
<td>
<p>logical; whether to plot simulation snaps</p>
</td></tr>
<tr><td><code id="run_simulation_:_visumin">visumin</code></td>
<td>
<p>logical; whether to plot a minimal visualization of the simulation</p>
</td></tr>
<tr><td><code id="run_simulation_:_ts">ts</code></td>
<td>
<p>Length of the simulation in years</p>
</td></tr>
<tr><td><code id="run_simulation_:_Kbase">Kbase</code></td>
<td>
<p>Named vector with carrying capacities for the cultures</p>
</td></tr>
<tr><td><code id="run_simulation_:_cul_ext">cul_ext</code></td>
<td>
<p>Named vector. Spatial penalty to extent: lower, bigger penality</p>
</td></tr>
<tr><td><code id="run_simulation_:_penal_cul">penal_cul</code></td>
<td>
<p>Named vector. Penality of occupational area:
if low, other sites can come close</p>
</td></tr>
<tr><td><code id="run_simulation_:_prob_birth">prob_birth</code></td>
<td>
<p>Named vector. Probability of giving birth every year</p>
</td></tr>
<tr><td><code id="run_simulation_:_prob_survive">prob_survive</code></td>
<td>
<p>Named vector. Probability of dying when the pop size is greater than the
carrying capacity</p>
</td></tr>
<tr><td><code id="run_simulation_:_prob_split">prob_split</code></td>
<td>
<p>Named vector. Probability of creating a new split settlement when the pop
size is greater than the carrying capacity</p>
</td></tr>
<tr><td><code id="run_simulation_:_prob_move">prob_move</code></td>
<td>
<p>Probability of migrating to a existing settlement when Ne &gt; K</p>
</td></tr>
<tr><td><code id="run_simulation_:_minimals">minimals</code></td>
<td>
<p>Named vector. How big, proportionally, the group of migrants
should be to create a new city vs migrate to a existing one.</p>
</td></tr>
<tr><td><code id="run_simulation_:_bufferatack">bufferatack</code></td>
<td>
<p>Maximum distance around which a settlement can fight</p>
</td></tr>
<tr><td><code id="run_simulation_:_buffersettl">buffersettl</code></td>
<td>
<p>Minimum distance around a site in which a new settlement cannnot settle</p>
</td></tr>
<tr><td><code id="run_simulation_:_Nts">Nts</code></td>
<td>
<p>Initiallized list of sites. Created with initlistsites.
Default is <code>NULL</code>, in which case it's created inside the function from <code>sites</code>.</p>
</td></tr>
<tr><td><code id="run_simulation_:_Ips">Ips</code></td>
<td>
<p>Initial population structure. Created with initpopstruc.
Default is <code>NULL</code>, in which case it's created inside the function from <code>sites</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with site data across the simulation period, population structures, war
casualties and updated sites positions.
</p>


</div>
</div>
<p><br></p>
<p>It uses a number of other functions to model contacts between sites, the outcomes of fights and migrations</p>
<p><br></p>
<div class="r-help-page"><div class="container">

<table style="width: 100%;"><tr><td>whotouch</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2 id='whotouch'>Check sites touching</h2>

<h3>Description</h3>

<p>Check who's touching a given site
</p>


<h3>Usage</h3>

<pre><code class='language-R'>whotouch(i, sites, Ne, homophily = F, buffersize = 200)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="whotouch_:_i">i</code></td>
<td>
<p>Index of the site checked</p>
</td></tr>
<tr><td><code id="whotouch_:_sites">sites</code></td>
<td>
<p>Raster with site coordinates, cultures and carrying capacities</p>
</td></tr>
<tr><td><code id="whotouch_:_Ne">Ne</code></td>
<td>
<p>population size of all sites</p>
</td></tr>
<tr><td><code id="whotouch_:_homophily">homophily</code></td>
<td>
<p>if true, return all sites that touch (even same culture)</p>
</td></tr>
<tr><td><code id="whotouch_:_buffersize">buffersize</code></td>
<td>
<p>Buffer size around a given site to consider contacts.
It's a factor that multiplies the population size Ne</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a raster with the sites that are touching site <code>i</code>
</p>


</div>
</div>
<p><br></p>
<p><br></p>
<div class="r-help-page"><div class="container">

<table style="width: 100%;"><tr><td>fightbetterloss</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2 id='fightbetterloss'>Model fight with better probabilities</h2>

<h3>Description</h3>

<p>A function to compute lost during a fighting.
The winner and looser are decided probabilistically from their relative size.
It then uses a binomial to model the loss of population sizes,
with probability based on their relative sizes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fightbetterloss(Ne, a, b)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fightbetterloss_:_Ne">Ne</code></td>
<td>
<p>list of population sizes for the fighting settlement</p>
</td></tr>
<tr><td><code id="fightbetterloss_:_a">a</code></td>
<td>
<p>indice of the first settlement</p>
</td></tr>
<tr><td><code id="fightbetterloss_:_b">b</code></td>
<td>
<p>indice of the second settlement</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the updated population size of both settlements engaged in the fight
</p>


</div>
</div>
<p><br></p>
<p><br></p>
<div class="r-help-page"><div class="container">

<table style="width: 100%;"><tr><td>changePopSize</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2 id='changePopSize'>Change population sizes</h2>

<h3>Description</h3>

<p>It changes population sizes due to killing or swap between
a loosing and winning population
</p>


<h3>Usage</h3>

<pre><code class='language-R'>changePopSize(
  loosingPop,
  size,
  winingPop = NULL,
  new = F,
  method = "random",
  probs = dnorm,
  prob.option = list(sd = 10, mean = 22)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="changePopSize_:_loosingPop">loosingPop</code></td>
<td>
<p>data.frame of the population that's decreasing</p>
</td></tr>
<tr><td><code id="changePopSize_:_size">size</code></td>
<td>
<p>Number of deaths or size of the population swap</p>
</td></tr>
<tr><td><code id="changePopSize_:_winingPop">winingPop</code></td>
<td>
<p>data.frame of the population that's increasing</p>
</td></tr>
<tr><td><code id="changePopSize_:_new">new</code></td>
<td>
<p>Deprecated</p>
</td></tr>
<tr><td><code id="changePopSize_:_method">method</code></td>
<td>
<p>Currently only supports &quot;random&quot;</p>
</td></tr>
<tr><td><code id="changePopSize_:_probs">probs</code></td>
<td>
<p>Density distribution function to calculate probabilities of individuals
to be sampled based on age</p>
</td></tr>
<tr><td><code id="changePopSize_:_prob.option">prob.option</code></td>
<td>
<p>Options for probs functions (e.g. <code>mean</code> and <code>sd</code> for <code>dnorm</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Either the updated loosing population data.frame or a list with both
the winning and loosing populations
</p>


</div>
</div>
<p><br></p>
<p><br></p>
<div class="r-help-page"><div class="container">

<table style="width: 100%;"><tr><td>warpoints</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2 id='warpoints'>Draw a war symbol where two clans are fighting</h2>

<h3>Description</h3>

<p>Draws a war symbol in the sites raster at the point of intersection between
fighting clans
</p>


<h3>Usage</h3>

<pre><code class='language-R'>warpoints(sites, a, b, Ne, buffersize = 300, plot = T, sizewar = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="warpoints_:_sites">sites</code></td>
<td>
<p>Raster with site coordinates, cultures and carrying capacities</p>
</td></tr>
<tr><td><code id="warpoints_:_a">a</code></td>
<td>
<p>Index of first settlement</p>
</td></tr>
<tr><td><code id="warpoints_:_b">b</code></td>
<td>
<p>Index of second settlement</p>
</td></tr>
<tr><td><code id="warpoints_:_Ne">Ne</code></td>
<td>
<p>Population sizes list</p>
</td></tr>
<tr><td><code id="warpoints_:_buffersize">buffersize</code></td>
<td>
<p>buffer size around a given site to consider contacts.
It's a factor that multiplies the population size Ne</p>
</td></tr>
<tr><td><code id="warpoints_:_plot">plot</code></td>
<td>
<p>Whether to make a plot or not</p>
</td></tr>
<tr><td><code id="warpoints_:_sizewar">sizewar</code></td>
<td>
<p>Size of the war symbol</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Raster of the intersection point between sites a and b, if any.
</p>


</div>
</div>
<p><br></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="population-growth-on-multiple-sites.html#cb34-1" tabindex="-1"></a></span>
<span id="cb34-2"><a href="population-growth-on-multiple-sites.html#cb34-2" tabindex="-1"></a></span>
<span id="cb34-3"><a href="population-growth-on-multiple-sites.html#cb34-3" tabindex="-1"></a>onesimu <span class="ot">&lt;-</span> <span class="fu">run_simulation</span>(</span>
<span id="cb34-4"><a href="population-growth-on-multiple-sites.html#cb34-4" tabindex="-1"></a>  <span class="at">sites=</span>sites, <span class="at">viable=</span>viable, <span class="at">dem=</span>height.ras,</span>
<span id="cb34-5"><a href="population-growth-on-multiple-sites.html#cb34-5" tabindex="-1"></a>  <span class="at">ressources=</span>ress,</span>
<span id="cb34-6"><a href="population-growth-on-multiple-sites.html#cb34-6" tabindex="-1"></a>  <span class="at">water=</span>height.wat,</span>
<span id="cb34-7"><a href="population-growth-on-multiple-sites.html#cb34-7" tabindex="-1"></a>  <span class="at">foldervid=</span><span class="st">&quot;nan&quot;</span>,</span>
<span id="cb34-8"><a href="population-growth-on-multiple-sites.html#cb34-8" tabindex="-1"></a>  <span class="at">visu=</span>F, <span class="at">visumin=</span>F,</span>
<span id="cb34-9"><a href="population-growth-on-multiple-sites.html#cb34-9" tabindex="-1"></a>  <span class="at">ts=</span>ts, <span class="co">#length of simulation in year</span></span>
<span id="cb34-10"><a href="population-growth-on-multiple-sites.html#cb34-10" tabindex="-1"></a>  <span class="at">Kbase=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="dv">35</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="dv">110</span>), <span class="co">#difference in K for the two cultures</span></span>
<span id="cb34-11"><a href="population-growth-on-multiple-sites.html#cb34-11" tabindex="-1"></a>  <span class="at">cul_ext=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="dv">7</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="dv">6</span>), <span class="co">#spatial penality to extent: lower, bigger penality</span></span>
<span id="cb34-12"><a href="population-growth-on-multiple-sites.html#cb34-12" tabindex="-1"></a>  <span class="at">penal_cul=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="dv">4</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="dv">5</span>), <span class="co">#penality of occupational area: low, other sites can cam close</span></span>
<span id="cb34-13"><a href="population-growth-on-multiple-sites.html#cb34-13" tabindex="-1"></a>  <span class="at">prob_birth=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="fl">0.3</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.5</span>), <span class="co">#proba of giving birth every year</span></span>
<span id="cb34-14"><a href="population-growth-on-multiple-sites.html#cb34-14" tabindex="-1"></a>  <span class="at">prob_survive=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="fl">0.8</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.65</span>), <span class="co">#proba of dying when pop &gt; K</span></span>
<span id="cb34-15"><a href="population-growth-on-multiple-sites.html#cb34-15" tabindex="-1"></a>  <span class="at">prob_split=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="fl">0.5</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.6</span>), <span class="co">#proba of creating a new settlement when Ne &gt; K</span></span>
<span id="cb34-16"><a href="population-growth-on-multiple-sites.html#cb34-16" tabindex="-1"></a>  <span class="at">minimals=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="fl">0.14</span>,<span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.20</span>), <span class="co">#how big the group of migrant should be to create a new city vs migrate to a existing one </span></span>
<span id="cb34-17"><a href="population-growth-on-multiple-sites.html#cb34-17" tabindex="-1"></a>  <span class="at">bufferatack=</span><span class="dv">300</span>, <span class="co">#distance max around which settlement can fight</span></span>
<span id="cb34-18"><a href="population-growth-on-multiple-sites.html#cb34-18" tabindex="-1"></a>  <span class="at">prob_move=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="fl">0.2</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.1</span>) <span class="co">#proba of migrating to existing settlement when Ne &gt; K</span></span>
<span id="cb34-19"><a href="population-growth-on-multiple-sites.html#cb34-19" tabindex="-1"></a>)</span>
<span id="cb34-20"><a href="population-growth-on-multiple-sites.html#cb34-20" tabindex="-1"></a><span class="do">## [1] &quot;year 2 total 987 with 20 sites ( F:1,HG:19 )&quot;</span></span>
<span id="cb34-21"><a href="population-growth-on-multiple-sites.html#cb34-21" tabindex="-1"></a><span class="do">## [1] &quot;year 3 total 1074 with 20 sites ( F:1,HG:19 )&quot;</span></span>
<span id="cb34-22"><a href="population-growth-on-multiple-sites.html#cb34-22" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb34-23"><a href="population-growth-on-multiple-sites.html#cb34-23" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 27 and pop 7&quot;</span></span>
<span id="cb34-24"><a href="population-growth-on-multiple-sites.html#cb34-24" tabindex="-1"></a><span class="do">## [1] &quot;year 4 total 1112 with 21 sites ( F:1,HG:20 )&quot;</span></span>
<span id="cb34-25"><a href="population-growth-on-multiple-sites.html#cb34-25" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb34-26"><a href="population-growth-on-multiple-sites.html#cb34-26" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb34-27"><a href="population-growth-on-multiple-sites.html#cb34-27" tabindex="-1"></a><span class="do">## [1] &quot;year 5 total 1123 with 21 sites ( F:1,HG:20 )&quot;</span></span>
<span id="cb34-28"><a href="population-growth-on-multiple-sites.html#cb34-28" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-29"><a href="population-growth-on-multiple-sites.html#cb34-29" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;19 migrant from F to F&quot;</span></span>
<span id="cb34-30"><a href="population-growth-on-multiple-sites.html#cb34-30" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 44 and pop 12&quot;</span></span>
<span id="cb34-31"><a href="population-growth-on-multiple-sites.html#cb34-31" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb34-32"><a href="population-growth-on-multiple-sites.html#cb34-32" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 29 and pop 8&quot;</span></span>
<span id="cb34-33"><a href="population-growth-on-multiple-sites.html#cb34-33" tabindex="-1"></a><span class="do">## [1] &quot;year 6 total 1152 with 23 sites ( F:1,HG:22 )&quot;</span></span>
<span id="cb34-34"><a href="population-growth-on-multiple-sites.html#cb34-34" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;26 migrant from F to F&quot;</span></span>
<span id="cb34-35"><a href="population-growth-on-multiple-sites.html#cb34-35" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;8 migrant from HG to HG&quot;</span></span>
<span id="cb34-36"><a href="population-growth-on-multiple-sites.html#cb34-36" tabindex="-1"></a><span class="do">## [1] &quot;year 7 total 1173 with 23 sites ( F:1,HG:22 )&quot;</span></span>
<span id="cb34-37"><a href="population-growth-on-multiple-sites.html#cb34-37" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (F) of K 109 and pop 31&quot;</span></span>
<span id="cb34-38"><a href="population-growth-on-multiple-sites.html#cb34-38" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-39"><a href="population-growth-on-multiple-sites.html#cb34-39" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 32 and pop 9&quot;</span></span>
<span id="cb34-40"><a href="population-growth-on-multiple-sites.html#cb34-40" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 29 and pop 10&quot;</span></span>
<span id="cb34-41"><a href="population-growth-on-multiple-sites.html#cb34-41" tabindex="-1"></a><span class="do">## [1] &quot;year 8 total 1204 with 26 sites ( F:2,HG:24 )&quot;</span></span>
<span id="cb34-42"><a href="population-growth-on-multiple-sites.html#cb34-42" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;8 migrant from HG to HG&quot;</span></span>
<span id="cb34-43"><a href="population-growth-on-multiple-sites.html#cb34-43" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-44"><a href="population-growth-on-multiple-sites.html#cb34-44" tabindex="-1"></a><span class="do">## [1] &quot;year 9 total 1238 with 26 sites ( F:2,HG:24 )&quot;</span></span>
<span id="cb34-45"><a href="population-growth-on-multiple-sites.html#cb34-45" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 22 and pop 7&quot;</span></span>
<span id="cb34-46"><a href="population-growth-on-multiple-sites.html#cb34-46" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-47"><a href="population-growth-on-multiple-sites.html#cb34-47" tabindex="-1"></a><span class="do">## [1] &quot;year 10 total 1248 with 27 sites ( F:2,HG:25 )&quot;</span></span>
<span id="cb34-48"><a href="population-growth-on-multiple-sites.html#cb34-48" tabindex="-1"></a><span class="do">## [1] &quot;year 11 total 1281 with 27 sites ( F:2,HG:25 )&quot;</span></span>
<span id="cb34-49"><a href="population-growth-on-multiple-sites.html#cb34-49" tabindex="-1"></a><span class="do">## [1] &quot;year 12 total 1292 with 27 sites ( F:2,HG:25 )&quot;</span></span>
<span id="cb34-50"><a href="population-growth-on-multiple-sites.html#cb34-50" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-51"><a href="population-growth-on-multiple-sites.html#cb34-51" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 49 and pop 10&quot;</span></span>
<span id="cb34-52"><a href="population-growth-on-multiple-sites.html#cb34-52" tabindex="-1"></a><span class="do">## [1] &quot;year 13 total 1308 with 28 sites ( F:2,HG:26 )&quot;</span></span>
<span id="cb34-53"><a href="population-growth-on-multiple-sites.html#cb34-53" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb34-54"><a href="population-growth-on-multiple-sites.html#cb34-54" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-55"><a href="population-growth-on-multiple-sites.html#cb34-55" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;8 migrant from HG to HG&quot;</span></span>
<span id="cb34-56"><a href="population-growth-on-multiple-sites.html#cb34-56" tabindex="-1"></a><span class="do">## [1] &quot;year 14 total 1310 with 28 sites ( F:2,HG:26 )&quot;</span></span>
<span id="cb34-57"><a href="population-growth-on-multiple-sites.html#cb34-57" tabindex="-1"></a><span class="do">## [1] &quot;year 15 total 1340 with 28 sites ( F:2,HG:26 )&quot;</span></span>
<span id="cb34-58"><a href="population-growth-on-multiple-sites.html#cb34-58" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb34-59"><a href="population-growth-on-multiple-sites.html#cb34-59" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb34-60"><a href="population-growth-on-multiple-sites.html#cb34-60" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb34-61"><a href="population-growth-on-multiple-sites.html#cb34-61" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 36 and pop 6&quot;</span></span>
<span id="cb34-62"><a href="population-growth-on-multiple-sites.html#cb34-62" tabindex="-1"></a><span class="do">## [1] &quot;year 16 total 1379 with 29 sites ( F:2,HG:27 )&quot;</span></span>
<span id="cb34-63"><a href="population-growth-on-multiple-sites.html#cb34-63" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-64"><a href="population-growth-on-multiple-sites.html#cb34-64" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-65"><a href="population-growth-on-multiple-sites.html#cb34-65" tabindex="-1"></a><span class="do">## [1] &quot;year 17 total 1381 with 29 sites ( F:2,HG:27 )&quot;</span></span>
<span id="cb34-66"><a href="population-growth-on-multiple-sites.html#cb34-66" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-67"><a href="population-growth-on-multiple-sites.html#cb34-67" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 54 and pop 6&quot;</span></span>
<span id="cb34-68"><a href="population-growth-on-multiple-sites.html#cb34-68" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-69"><a href="population-growth-on-multiple-sites.html#cb34-69" tabindex="-1"></a><span class="do">## [1] &quot;year 18 total 1390 with 30 sites ( F:2,HG:28 )&quot;</span></span>
<span id="cb34-70"><a href="population-growth-on-multiple-sites.html#cb34-70" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-71"><a href="population-growth-on-multiple-sites.html#cb34-71" tabindex="-1"></a><span class="do">## [1] &quot;year 19 total 1390 with 30 sites ( F:2,HG:28 )&quot;</span></span>
<span id="cb34-72"><a href="population-growth-on-multiple-sites.html#cb34-72" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-73"><a href="population-growth-on-multiple-sites.html#cb34-73" tabindex="-1"></a><span class="do">## [1] &quot;year 20 total 1371 with 30 sites ( F:2,HG:28 )&quot;</span></span>
<span id="cb34-74"><a href="population-growth-on-multiple-sites.html#cb34-74" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb34-75"><a href="population-growth-on-multiple-sites.html#cb34-75" tabindex="-1"></a><span class="do">## [1] &quot;year 21 total 1372 with 30 sites ( F:2,HG:28 )&quot;</span></span>
<span id="cb34-76"><a href="population-growth-on-multiple-sites.html#cb34-76" tabindex="-1"></a><span class="do">## [1] &quot;year 22 total 1347 with 30 sites ( F:2,HG:28 )&quot;</span></span>
<span id="cb34-77"><a href="population-growth-on-multiple-sites.html#cb34-77" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-78"><a href="population-growth-on-multiple-sites.html#cb34-78" tabindex="-1"></a><span class="do">## [1] &quot;year 23 total 1351 with 30 sites ( F:2,HG:28 )&quot;</span></span>
<span id="cb34-79"><a href="population-growth-on-multiple-sites.html#cb34-79" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;2 migrant from HG to HG&quot;</span></span>
<span id="cb34-80"><a href="population-growth-on-multiple-sites.html#cb34-80" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;11 migrant from F to F&quot;</span></span>
<span id="cb34-81"><a href="population-growth-on-multiple-sites.html#cb34-81" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-82"><a href="population-growth-on-multiple-sites.html#cb34-82" tabindex="-1"></a><span class="do">## [1] &quot;year 24 total 1339 with 30 sites ( F:2,HG:28 )&quot;</span></span>
<span id="cb34-83"><a href="population-growth-on-multiple-sites.html#cb34-83" tabindex="-1"></a><span class="do">## [1] &quot;year 25 total 1340 with 30 sites ( F:2,HG:28 )&quot;</span></span>
<span id="cb34-84"><a href="population-growth-on-multiple-sites.html#cb34-84" tabindex="-1"></a><span class="do">## [1] &quot;year 26 total 1314 with 30 sites ( F:2,HG:28 )&quot;</span></span>
<span id="cb34-85"><a href="population-growth-on-multiple-sites.html#cb34-85" tabindex="-1"></a><span class="do">## [1] &quot;year 27 total 1333 with 30 sites ( F:2,HG:28 )&quot;</span></span>
<span id="cb34-86"><a href="population-growth-on-multiple-sites.html#cb34-86" tabindex="-1"></a><span class="do">## [1] &quot;year 28 total 1331 with 30 sites ( F:2,HG:28 )&quot;</span></span>
<span id="cb34-87"><a href="population-growth-on-multiple-sites.html#cb34-87" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-88"><a href="population-growth-on-multiple-sites.html#cb34-88" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-89"><a href="population-growth-on-multiple-sites.html#cb34-89" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;20 migrant from F to F&quot;</span></span>
<span id="cb34-90"><a href="population-growth-on-multiple-sites.html#cb34-90" tabindex="-1"></a><span class="do">## [1] &quot;year 29 total 1339 with 30 sites ( F:2,HG:28 )&quot;</span></span>
<span id="cb34-91"><a href="population-growth-on-multiple-sites.html#cb34-91" tabindex="-1"></a><span class="do">## [1] &quot;year 30 total 1316 with 30 sites ( F:2,HG:28 )&quot;</span></span>
<span id="cb34-92"><a href="population-growth-on-multiple-sites.html#cb34-92" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-93"><a href="population-growth-on-multiple-sites.html#cb34-93" tabindex="-1"></a><span class="do">## [1] &quot;year 31 total 1310 with 30 sites ( F:2,HG:28 )&quot;</span></span>
<span id="cb34-94"><a href="population-growth-on-multiple-sites.html#cb34-94" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-95"><a href="population-growth-on-multiple-sites.html#cb34-95" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;14 migrant from F to F&quot;</span></span>
<span id="cb34-96"><a href="population-growth-on-multiple-sites.html#cb34-96" tabindex="-1"></a><span class="do">## [1] &quot;year 32 total 1324 with 30 sites ( F:2,HG:28 )&quot;</span></span>
<span id="cb34-97"><a href="population-growth-on-multiple-sites.html#cb34-97" tabindex="-1"></a><span class="do">## [1] &quot;year 33 total 1344 with 30 sites ( F:2,HG:28 )&quot;</span></span>
<span id="cb34-98"><a href="population-growth-on-multiple-sites.html#cb34-98" tabindex="-1"></a><span class="do">## [1] &quot;year 34 total 1348 with 30 sites ( F:2,HG:28 )&quot;</span></span>
<span id="cb34-99"><a href="population-growth-on-multiple-sites.html#cb34-99" tabindex="-1"></a><span class="do">## [1] &quot;year 35 total 1338 with 30 sites ( F:2,HG:28 )&quot;</span></span>
<span id="cb34-100"><a href="population-growth-on-multiple-sites.html#cb34-100" tabindex="-1"></a><span class="do">## [1] &quot;year 36 total 1343 with 30 sites ( F:2,HG:28 )&quot;</span></span>
<span id="cb34-101"><a href="population-growth-on-multiple-sites.html#cb34-101" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;18 migrant from F to F&quot;</span></span>
<span id="cb34-102"><a href="population-growth-on-multiple-sites.html#cb34-102" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 32 and pop 9&quot;</span></span>
<span id="cb34-103"><a href="population-growth-on-multiple-sites.html#cb34-103" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-104"><a href="population-growth-on-multiple-sites.html#cb34-104" tabindex="-1"></a><span class="do">## [1] &quot;year 37 total 1352 with 31 sites ( F:2,HG:29 )&quot;</span></span>
<span id="cb34-105"><a href="population-growth-on-multiple-sites.html#cb34-105" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-106"><a href="population-growth-on-multiple-sites.html#cb34-106" tabindex="-1"></a><span class="do">## [1] &quot;year 38 total 1335 with 31 sites ( F:2,HG:29 )&quot;</span></span>
<span id="cb34-107"><a href="population-growth-on-multiple-sites.html#cb34-107" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-108"><a href="population-growth-on-multiple-sites.html#cb34-108" tabindex="-1"></a><span class="do">## [1] &quot;year 39 total 1348 with 31 sites ( F:2,HG:29 )&quot;</span></span>
<span id="cb34-109"><a href="population-growth-on-multiple-sites.html#cb34-109" tabindex="-1"></a><span class="do">## [1] &quot;year 40 total 1353 with 31 sites ( F:2,HG:29 )&quot;</span></span>
<span id="cb34-110"><a href="population-growth-on-multiple-sites.html#cb34-110" tabindex="-1"></a><span class="do">## [1] &quot;year 41 total 1365 with 31 sites ( F:2,HG:29 )&quot;</span></span>
<span id="cb34-111"><a href="population-growth-on-multiple-sites.html#cb34-111" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;13 migrant from F to F&quot;</span></span>
<span id="cb34-112"><a href="population-growth-on-multiple-sites.html#cb34-112" tabindex="-1"></a><span class="do">## [1] &quot;year 42 total 1353 with 31 sites ( F:2,HG:29 )&quot;</span></span>
<span id="cb34-113"><a href="population-growth-on-multiple-sites.html#cb34-113" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-114"><a href="population-growth-on-multiple-sites.html#cb34-114" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-115"><a href="population-growth-on-multiple-sites.html#cb34-115" tabindex="-1"></a><span class="do">## [1] &quot;year 43 total 1379 with 31 sites ( F:2,HG:29 )&quot;</span></span>
<span id="cb34-116"><a href="population-growth-on-multiple-sites.html#cb34-116" tabindex="-1"></a><span class="do">## [1] &quot;year 44 total 1377 with 31 sites ( F:2,HG:29 )&quot;</span></span>
<span id="cb34-117"><a href="population-growth-on-multiple-sites.html#cb34-117" tabindex="-1"></a><span class="do">## [1] &quot;year 45 total 1388 with 31 sites ( F:2,HG:29 )&quot;</span></span>
<span id="cb34-118"><a href="population-growth-on-multiple-sites.html#cb34-118" tabindex="-1"></a><span class="do">## [1] &quot;year 46 total 1404 with 31 sites ( F:2,HG:29 )&quot;</span></span>
<span id="cb34-119"><a href="population-growth-on-multiple-sites.html#cb34-119" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-120"><a href="population-growth-on-multiple-sites.html#cb34-120" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb34-121"><a href="population-growth-on-multiple-sites.html#cb34-121" tabindex="-1"></a><span class="do">## [1] &quot;year 47 total 1415 with 31 sites ( F:2,HG:29 )&quot;</span></span>
<span id="cb34-122"><a href="population-growth-on-multiple-sites.html#cb34-122" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;13 migrant from F to F&quot;</span></span>
<span id="cb34-123"><a href="population-growth-on-multiple-sites.html#cb34-123" tabindex="-1"></a><span class="do">## [1] &quot;year 48 total 1409 with 31 sites ( F:2,HG:29 )&quot;</span></span>
<span id="cb34-124"><a href="population-growth-on-multiple-sites.html#cb34-124" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-125"><a href="population-growth-on-multiple-sites.html#cb34-125" tabindex="-1"></a><span class="do">## [1] &quot;year 49 total 1398 with 31 sites ( F:2,HG:29 )&quot;</span></span>
<span id="cb34-126"><a href="population-growth-on-multiple-sites.html#cb34-126" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;9 migrant from HG to HG&quot;</span></span>
<span id="cb34-127"><a href="population-growth-on-multiple-sites.html#cb34-127" tabindex="-1"></a><span class="do">## [1] &quot;year 50 total 1418 with 31 sites ( F:2,HG:29 )&quot;</span></span>
<span id="cb34-128"><a href="population-growth-on-multiple-sites.html#cb34-128" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb34-129"><a href="population-growth-on-multiple-sites.html#cb34-129" tabindex="-1"></a><span class="do">## [1] &quot;year 51 total 1414 with 31 sites ( F:2,HG:29 )&quot;</span></span>
<span id="cb34-130"><a href="population-growth-on-multiple-sites.html#cb34-130" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb34-131"><a href="population-growth-on-multiple-sites.html#cb34-131" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb34-132"><a href="population-growth-on-multiple-sites.html#cb34-132" tabindex="-1"></a><span class="do">## [1] &quot;year 52 total 1415 with 31 sites ( F:2,HG:29 )&quot;</span></span>
<span id="cb34-133"><a href="population-growth-on-multiple-sites.html#cb34-133" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 47 and pop 8&quot;</span></span>
<span id="cb34-134"><a href="population-growth-on-multiple-sites.html#cb34-134" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 36 and pop 6&quot;</span></span>
<span id="cb34-135"><a href="population-growth-on-multiple-sites.html#cb34-135" tabindex="-1"></a><span class="do">## [1] &quot;year 53 total 1440 with 33 sites ( F:2,HG:31 )&quot;</span></span>
<span id="cb34-136"><a href="population-growth-on-multiple-sites.html#cb34-136" tabindex="-1"></a><span class="do">## [1] &quot;year 54 total 1439 with 33 sites ( F:2,HG:31 )&quot;</span></span>
<span id="cb34-137"><a href="population-growth-on-multiple-sites.html#cb34-137" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-138"><a href="population-growth-on-multiple-sites.html#cb34-138" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb34-139"><a href="population-growth-on-multiple-sites.html#cb34-139" tabindex="-1"></a><span class="do">## [1] &quot;year 55 total 1467 with 33 sites ( F:2,HG:31 )&quot;</span></span>
<span id="cb34-140"><a href="population-growth-on-multiple-sites.html#cb34-140" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;2 migrant from HG to HG&quot;</span></span>
<span id="cb34-141"><a href="population-growth-on-multiple-sites.html#cb34-141" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;8 migrant from HG to HG&quot;</span></span>
<span id="cb34-142"><a href="population-growth-on-multiple-sites.html#cb34-142" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 43 and pop 7&quot;</span></span>
<span id="cb34-143"><a href="population-growth-on-multiple-sites.html#cb34-143" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;11 migrant from F to F&quot;</span></span>
<span id="cb34-144"><a href="population-growth-on-multiple-sites.html#cb34-144" tabindex="-1"></a><span class="do">## [1] &quot;year 56 total 1484 with 34 sites ( F:2,HG:32 )&quot;</span></span>
<span id="cb34-145"><a href="population-growth-on-multiple-sites.html#cb34-145" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-146"><a href="population-growth-on-multiple-sites.html#cb34-146" tabindex="-1"></a><span class="do">## [1] &quot;year 57 total 1493 with 34 sites ( F:2,HG:32 )&quot;</span></span>
<span id="cb34-147"><a href="population-growth-on-multiple-sites.html#cb34-147" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;13 migrant from F to F&quot;</span></span>
<span id="cb34-148"><a href="population-growth-on-multiple-sites.html#cb34-148" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-149"><a href="population-growth-on-multiple-sites.html#cb34-149" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb34-150"><a href="population-growth-on-multiple-sites.html#cb34-150" tabindex="-1"></a><span class="do">## [1] &quot;year 58 total 1474 with 34 sites ( F:2,HG:32 )&quot;</span></span>
<span id="cb34-151"><a href="population-growth-on-multiple-sites.html#cb34-151" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb34-152"><a href="population-growth-on-multiple-sites.html#cb34-152" tabindex="-1"></a><span class="do">## [1] &quot;year 59 total 1498 with 34 sites ( F:2,HG:32 )&quot;</span></span>
<span id="cb34-153"><a href="population-growth-on-multiple-sites.html#cb34-153" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;16 migrant from F to F&quot;</span></span>
<span id="cb34-154"><a href="population-growth-on-multiple-sites.html#cb34-154" tabindex="-1"></a><span class="do">## [1] &quot;year 60 total 1484 with 34 sites ( F:2,HG:32 )&quot;</span></span>
<span id="cb34-155"><a href="population-growth-on-multiple-sites.html#cb34-155" tabindex="-1"></a><span class="do">## [1] &quot;year 61 total 1463 with 34 sites ( F:2,HG:32 )&quot;</span></span>
<span id="cb34-156"><a href="population-growth-on-multiple-sites.html#cb34-156" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;15 migrant from F to F&quot;</span></span>
<span id="cb34-157"><a href="population-growth-on-multiple-sites.html#cb34-157" tabindex="-1"></a><span class="do">## [1] &quot;year 62 total 1479 with 34 sites ( F:2,HG:32 )&quot;</span></span>
<span id="cb34-158"><a href="population-growth-on-multiple-sites.html#cb34-158" tabindex="-1"></a><span class="do">## [1] &quot;year 63 total 1473 with 34 sites ( F:2,HG:32 )&quot;</span></span>
<span id="cb34-159"><a href="population-growth-on-multiple-sites.html#cb34-159" tabindex="-1"></a><span class="do">## [1] &quot;year 64 total 1486 with 34 sites ( F:2,HG:32 )&quot;</span></span>
<span id="cb34-160"><a href="population-growth-on-multiple-sites.html#cb34-160" tabindex="-1"></a><span class="do">## [1] &quot;year 65 total 1476 with 34 sites ( F:2,HG:32 )&quot;</span></span>
<span id="cb34-161"><a href="population-growth-on-multiple-sites.html#cb34-161" tabindex="-1"></a><span class="do">## [1] &quot;year 66 total 1473 with 34 sites ( F:2,HG:32 )&quot;</span></span>
<span id="cb34-162"><a href="population-growth-on-multiple-sites.html#cb34-162" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 33 and pop 5&quot;</span></span>
<span id="cb34-163"><a href="population-growth-on-multiple-sites.html#cb34-163" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-164"><a href="population-growth-on-multiple-sites.html#cb34-164" tabindex="-1"></a><span class="do">## [1] &quot;year 67 total 1492 with 35 sites ( F:2,HG:33 )&quot;</span></span>
<span id="cb34-165"><a href="population-growth-on-multiple-sites.html#cb34-165" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb34-166"><a href="population-growth-on-multiple-sites.html#cb34-166" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 39 and pop 12&quot;</span></span>
<span id="cb34-167"><a href="population-growth-on-multiple-sites.html#cb34-167" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb34-168"><a href="population-growth-on-multiple-sites.html#cb34-168" tabindex="-1"></a><span class="do">## [1] &quot;year 68 total 1515 with 36 sites ( F:2,HG:34 )&quot;</span></span>
<span id="cb34-169"><a href="population-growth-on-multiple-sites.html#cb34-169" tabindex="-1"></a><span class="do">## [1] &quot;year 69 total 1528 with 36 sites ( F:2,HG:34 )&quot;</span></span>
<span id="cb34-170"><a href="population-growth-on-multiple-sites.html#cb34-170" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb34-171"><a href="population-growth-on-multiple-sites.html#cb34-171" tabindex="-1"></a><span class="do">## [1] &quot;year 70 total 1534 with 36 sites ( F:2,HG:34 )&quot;</span></span>
<span id="cb34-172"><a href="population-growth-on-multiple-sites.html#cb34-172" tabindex="-1"></a><span class="do">## [1] &quot;year 71 total 1522 with 36 sites ( F:2,HG:34 )&quot;</span></span>
<span id="cb34-173"><a href="population-growth-on-multiple-sites.html#cb34-173" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-174"><a href="population-growth-on-multiple-sites.html#cb34-174" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb34-175"><a href="population-growth-on-multiple-sites.html#cb34-175" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-176"><a href="population-growth-on-multiple-sites.html#cb34-176" tabindex="-1"></a><span class="do">## [1] &quot;year 72 total 1523 with 36 sites ( F:2,HG:34 )&quot;</span></span>
<span id="cb34-177"><a href="population-growth-on-multiple-sites.html#cb34-177" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-178"><a href="population-growth-on-multiple-sites.html#cb34-178" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb34-179"><a href="population-growth-on-multiple-sites.html#cb34-179" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-180"><a href="population-growth-on-multiple-sites.html#cb34-180" tabindex="-1"></a><span class="do">## [1] &quot;year 73 total 1523 with 36 sites ( F:2,HG:34 )&quot;</span></span>
<span id="cb34-181"><a href="population-growth-on-multiple-sites.html#cb34-181" tabindex="-1"></a><span class="do">## [1] &quot;year 74 total 1517 with 36 sites ( F:2,HG:34 )&quot;</span></span>
<span id="cb34-182"><a href="population-growth-on-multiple-sites.html#cb34-182" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-183"><a href="population-growth-on-multiple-sites.html#cb34-183" tabindex="-1"></a><span class="do">## [1] &quot;year 75 total 1523 with 36 sites ( F:2,HG:34 )&quot;</span></span>
<span id="cb34-184"><a href="population-growth-on-multiple-sites.html#cb34-184" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-185"><a href="population-growth-on-multiple-sites.html#cb34-185" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-186"><a href="population-growth-on-multiple-sites.html#cb34-186" tabindex="-1"></a><span class="do">## [1] &quot;year 76 total 1531 with 36 sites ( F:2,HG:34 )&quot;</span></span>
<span id="cb34-187"><a href="population-growth-on-multiple-sites.html#cb34-187" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-188"><a href="population-growth-on-multiple-sites.html#cb34-188" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-189"><a href="population-growth-on-multiple-sites.html#cb34-189" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 32 and pop 6&quot;</span></span>
<span id="cb34-190"><a href="population-growth-on-multiple-sites.html#cb34-190" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb34-191"><a href="population-growth-on-multiple-sites.html#cb34-191" tabindex="-1"></a><span class="do">## [1] &quot;year 77 total 1531 with 37 sites ( F:2,HG:35 )&quot;</span></span>
<span id="cb34-192"><a href="population-growth-on-multiple-sites.html#cb34-192" tabindex="-1"></a><span class="do">## [1] &quot;year 78 total 1524 with 37 sites ( F:2,HG:35 )&quot;</span></span>
<span id="cb34-193"><a href="population-growth-on-multiple-sites.html#cb34-193" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-194"><a href="population-growth-on-multiple-sites.html#cb34-194" tabindex="-1"></a><span class="do">## [1] &quot;year 79 total 1555 with 37 sites ( F:2,HG:35 )&quot;</span></span>
<span id="cb34-195"><a href="population-growth-on-multiple-sites.html#cb34-195" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-196"><a href="population-growth-on-multiple-sites.html#cb34-196" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;8 migrant from HG to HG&quot;</span></span>
<span id="cb34-197"><a href="population-growth-on-multiple-sites.html#cb34-197" tabindex="-1"></a><span class="do">## [1] &quot;year 80 total 1576 with 37 sites ( F:2,HG:35 )&quot;</span></span>
<span id="cb34-198"><a href="population-growth-on-multiple-sites.html#cb34-198" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-199"><a href="population-growth-on-multiple-sites.html#cb34-199" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 28 and pop 5&quot;</span></span>
<span id="cb34-200"><a href="population-growth-on-multiple-sites.html#cb34-200" tabindex="-1"></a><span class="do">## [1] &quot;year 81 total 1580 with 38 sites ( F:2,HG:36 )&quot;</span></span>
<span id="cb34-201"><a href="population-growth-on-multiple-sites.html#cb34-201" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;14 migrant from F to F&quot;</span></span>
<span id="cb34-202"><a href="population-growth-on-multiple-sites.html#cb34-202" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-203"><a href="population-growth-on-multiple-sites.html#cb34-203" tabindex="-1"></a><span class="do">## [1] &quot;year 82 total 1601 with 38 sites ( F:2,HG:36 )&quot;</span></span>
<span id="cb34-204"><a href="population-growth-on-multiple-sites.html#cb34-204" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (F) of K 307 and pop 22&quot;</span></span>
<span id="cb34-205"><a href="population-growth-on-multiple-sites.html#cb34-205" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb34-206"><a href="population-growth-on-multiple-sites.html#cb34-206" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-207"><a href="population-growth-on-multiple-sites.html#cb34-207" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb34-208"><a href="population-growth-on-multiple-sites.html#cb34-208" tabindex="-1"></a><span class="do">## [1] &quot;year 83 total 1621 with 39 sites ( F:3,HG:36 )&quot;</span></span>
<span id="cb34-209"><a href="population-growth-on-multiple-sites.html#cb34-209" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;8 migrant from HG to HG&quot;</span></span>
<span id="cb34-210"><a href="population-growth-on-multiple-sites.html#cb34-210" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb34-211"><a href="population-growth-on-multiple-sites.html#cb34-211" tabindex="-1"></a><span class="do">## [1] &quot;year 84 total 1635 with 39 sites ( F:3,HG:36 )&quot;</span></span>
<span id="cb34-212"><a href="population-growth-on-multiple-sites.html#cb34-212" tabindex="-1"></a><span class="do">## [1] &quot;year 85 total 1636 with 39 sites ( F:3,HG:36 )&quot;</span></span>
<span id="cb34-213"><a href="population-growth-on-multiple-sites.html#cb34-213" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb34-214"><a href="population-growth-on-multiple-sites.html#cb34-214" tabindex="-1"></a><span class="do">## [1] &quot;year 86 total 1656 with 39 sites ( F:3,HG:36 )&quot;</span></span>
<span id="cb34-215"><a href="population-growth-on-multiple-sites.html#cb34-215" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-216"><a href="population-growth-on-multiple-sites.html#cb34-216" tabindex="-1"></a><span class="do">## [1] &quot;year 87 total 1643 with 39 sites ( F:3,HG:36 )&quot;</span></span>
<span id="cb34-217"><a href="population-growth-on-multiple-sites.html#cb34-217" tabindex="-1"></a><span class="do">## [1] &quot;year 88 total 1657 with 39 sites ( F:3,HG:36 )&quot;</span></span>
<span id="cb34-218"><a href="population-growth-on-multiple-sites.html#cb34-218" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-219"><a href="population-growth-on-multiple-sites.html#cb34-219" tabindex="-1"></a><span class="do">## [1] &quot;year 89 total 1667 with 39 sites ( F:3,HG:36 )&quot;</span></span>
<span id="cb34-220"><a href="population-growth-on-multiple-sites.html#cb34-220" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb34-221"><a href="population-growth-on-multiple-sites.html#cb34-221" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;2 migrant from HG to HG&quot;</span></span>
<span id="cb34-222"><a href="population-growth-on-multiple-sites.html#cb34-222" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;17 migrant from F to F&quot;</span></span>
<span id="cb34-223"><a href="population-growth-on-multiple-sites.html#cb34-223" tabindex="-1"></a><span class="do">## [1] &quot;year 90 total 1678 with 39 sites ( F:3,HG:36 )&quot;</span></span>
<span id="cb34-224"><a href="population-growth-on-multiple-sites.html#cb34-224" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-225"><a href="population-growth-on-multiple-sites.html#cb34-225" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb34-226"><a href="population-growth-on-multiple-sites.html#cb34-226" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-227"><a href="population-growth-on-multiple-sites.html#cb34-227" tabindex="-1"></a><span class="do">## [1] &quot;year 91 total 1688 with 39 sites ( F:3,HG:36 )&quot;</span></span>
<span id="cb34-228"><a href="population-growth-on-multiple-sites.html#cb34-228" tabindex="-1"></a><span class="do">## [1] &quot;year 92 total 1696 with 39 sites ( F:3,HG:36 )&quot;</span></span>
<span id="cb34-229"><a href="population-growth-on-multiple-sites.html#cb34-229" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 48 and pop 7&quot;</span></span>
<span id="cb34-230"><a href="population-growth-on-multiple-sites.html#cb34-230" tabindex="-1"></a><span class="do">## [1] &quot;year 93 total 1720 with 40 sites ( F:3,HG:37 )&quot;</span></span>
<span id="cb34-231"><a href="population-growth-on-multiple-sites.html#cb34-231" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb34-232"><a href="population-growth-on-multiple-sites.html#cb34-232" tabindex="-1"></a><span class="do">## [1] &quot;year 94 total 1753 with 40 sites ( F:3,HG:37 )&quot;</span></span>
<span id="cb34-233"><a href="population-growth-on-multiple-sites.html#cb34-233" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-234"><a href="population-growth-on-multiple-sites.html#cb34-234" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-235"><a href="population-growth-on-multiple-sites.html#cb34-235" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-236"><a href="population-growth-on-multiple-sites.html#cb34-236" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-237"><a href="population-growth-on-multiple-sites.html#cb34-237" tabindex="-1"></a><span class="do">## [1] &quot;year 95 total 1792 with 40 sites ( F:3,HG:37 )&quot;</span></span>
<span id="cb34-238"><a href="population-growth-on-multiple-sites.html#cb34-238" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb34-239"><a href="population-growth-on-multiple-sites.html#cb34-239" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-240"><a href="population-growth-on-multiple-sites.html#cb34-240" tabindex="-1"></a><span class="do">## [1] &quot;year 96 total 1787 with 40 sites ( F:3,HG:37 )&quot;</span></span>
<span id="cb34-241"><a href="population-growth-on-multiple-sites.html#cb34-241" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;15 migrant from F to F&quot;</span></span>
<span id="cb34-242"><a href="population-growth-on-multiple-sites.html#cb34-242" tabindex="-1"></a><span class="do">## [1] &quot;year 97 total 1783 with 40 sites ( F:3,HG:37 )&quot;</span></span>
<span id="cb34-243"><a href="population-growth-on-multiple-sites.html#cb34-243" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb34-244"><a href="population-growth-on-multiple-sites.html#cb34-244" tabindex="-1"></a><span class="do">## [1] &quot;year 98 total 1776 with 40 sites ( F:3,HG:37 )&quot;</span></span>
<span id="cb34-245"><a href="population-growth-on-multiple-sites.html#cb34-245" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;2 migrant from HG to HG&quot;</span></span>
<span id="cb34-246"><a href="population-growth-on-multiple-sites.html#cb34-246" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-247"><a href="population-growth-on-multiple-sites.html#cb34-247" tabindex="-1"></a><span class="do">## [1] &quot;year 99 total 1809 with 40 sites ( F:3,HG:37 )&quot;</span></span>
<span id="cb34-248"><a href="population-growth-on-multiple-sites.html#cb34-248" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-249"><a href="population-growth-on-multiple-sites.html#cb34-249" tabindex="-1"></a><span class="do">## [1] &quot;year 100 total 1811 with 40 sites ( F:3,HG:37 )&quot;</span></span>
<span id="cb34-250"><a href="population-growth-on-multiple-sites.html#cb34-250" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-251"><a href="population-growth-on-multiple-sites.html#cb34-251" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 38 and pop 11&quot;</span></span>
<span id="cb34-252"><a href="population-growth-on-multiple-sites.html#cb34-252" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-253"><a href="population-growth-on-multiple-sites.html#cb34-253" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;18 migrant from F to F&quot;</span></span>
<span id="cb34-254"><a href="population-growth-on-multiple-sites.html#cb34-254" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-255"><a href="population-growth-on-multiple-sites.html#cb34-255" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb34-256"><a href="population-growth-on-multiple-sites.html#cb34-256" tabindex="-1"></a><span class="do">## [1] &quot;year 101 total 1843 with 41 sites ( F:3,HG:38 )&quot;</span></span>
<span id="cb34-257"><a href="population-growth-on-multiple-sites.html#cb34-257" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-258"><a href="population-growth-on-multiple-sites.html#cb34-258" tabindex="-1"></a><span class="do">## [1] &quot;year 102 total 1832 with 41 sites ( F:3,HG:38 )&quot;</span></span>
<span id="cb34-259"><a href="population-growth-on-multiple-sites.html#cb34-259" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 30 and pop 7&quot;</span></span>
<span id="cb34-260"><a href="population-growth-on-multiple-sites.html#cb34-260" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-261"><a href="population-growth-on-multiple-sites.html#cb34-261" tabindex="-1"></a><span class="do">## [1] &quot;year 103 total 1879 with 42 sites ( F:3,HG:39 )&quot;</span></span>
<span id="cb34-262"><a href="population-growth-on-multiple-sites.html#cb34-262" tabindex="-1"></a><span class="do">## [1] &quot;year 104 total 1905 with 42 sites ( F:3,HG:39 )&quot;</span></span>
<span id="cb34-263"><a href="population-growth-on-multiple-sites.html#cb34-263" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;2 migrant from HG to HG&quot;</span></span>
<span id="cb34-264"><a href="population-growth-on-multiple-sites.html#cb34-264" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-265"><a href="population-growth-on-multiple-sites.html#cb34-265" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-266"><a href="population-growth-on-multiple-sites.html#cb34-266" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb34-267"><a href="population-growth-on-multiple-sites.html#cb34-267" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;11 migrant from F to F&quot;</span></span>
<span id="cb34-268"><a href="population-growth-on-multiple-sites.html#cb34-268" tabindex="-1"></a><span class="do">## [1] &quot;year 105 total 1936 with 42 sites ( F:3,HG:39 )&quot;</span></span>
<span id="cb34-269"><a href="population-growth-on-multiple-sites.html#cb34-269" tabindex="-1"></a><span class="do">## [1] &quot;year 106 total 1943 with 42 sites ( F:3,HG:39 )&quot;</span></span>
<span id="cb34-270"><a href="population-growth-on-multiple-sites.html#cb34-270" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-271"><a href="population-growth-on-multiple-sites.html#cb34-271" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-272"><a href="population-growth-on-multiple-sites.html#cb34-272" tabindex="-1"></a><span class="do">## [1] &quot;year 107 total 1965 with 42 sites ( F:3,HG:39 )&quot;</span></span>
<span id="cb34-273"><a href="population-growth-on-multiple-sites.html#cb34-273" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 42 and pop 6&quot;</span></span>
<span id="cb34-274"><a href="population-growth-on-multiple-sites.html#cb34-274" tabindex="-1"></a><span class="do">## [1] &quot;year 108 total 1974 with 43 sites ( F:3,HG:40 )&quot;</span></span>
<span id="cb34-275"><a href="population-growth-on-multiple-sites.html#cb34-275" tabindex="-1"></a><span class="do">## [1] &quot;year 109 total 1971 with 43 sites ( F:3,HG:40 )&quot;</span></span>
<span id="cb34-276"><a href="population-growth-on-multiple-sites.html#cb34-276" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;15 migrant from F to F&quot;</span></span>
<span id="cb34-277"><a href="population-growth-on-multiple-sites.html#cb34-277" tabindex="-1"></a><span class="do">## [1] &quot;year 110 total 1988 with 43 sites ( F:3,HG:40 )&quot;</span></span>
<span id="cb34-278"><a href="population-growth-on-multiple-sites.html#cb34-278" tabindex="-1"></a><span class="do">## [1] &quot;year 111 total 2025 with 43 sites ( F:3,HG:40 )&quot;</span></span>
<span id="cb34-279"><a href="population-growth-on-multiple-sites.html#cb34-279" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-280"><a href="population-growth-on-multiple-sites.html#cb34-280" tabindex="-1"></a><span class="do">## [1] &quot;year 112 total 2050 with 43 sites ( F:3,HG:40 )&quot;</span></span>
<span id="cb34-281"><a href="population-growth-on-multiple-sites.html#cb34-281" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-282"><a href="population-growth-on-multiple-sites.html#cb34-282" tabindex="-1"></a><span class="do">## [1] &quot;year 113 total 2084 with 43 sites ( F:3,HG:40 )&quot;</span></span>
<span id="cb34-283"><a href="population-growth-on-multiple-sites.html#cb34-283" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-284"><a href="population-growth-on-multiple-sites.html#cb34-284" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-285"><a href="population-growth-on-multiple-sites.html#cb34-285" tabindex="-1"></a><span class="do">## [1] &quot;year 114 total 2097 with 43 sites ( F:3,HG:40 )&quot;</span></span>
<span id="cb34-286"><a href="population-growth-on-multiple-sites.html#cb34-286" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-287"><a href="population-growth-on-multiple-sites.html#cb34-287" tabindex="-1"></a><span class="do">## [1] &quot;year 115 total 2085 with 43 sites ( F:3,HG:40 )&quot;</span></span>
<span id="cb34-288"><a href="population-growth-on-multiple-sites.html#cb34-288" tabindex="-1"></a><span class="do">## [1] &quot;year 116 total 2082 with 43 sites ( F:3,HG:40 )&quot;</span></span>
<span id="cb34-289"><a href="population-growth-on-multiple-sites.html#cb34-289" tabindex="-1"></a><span class="do">## [1] &quot;year 117 total 2087 with 43 sites ( F:3,HG:40 )&quot;</span></span>
<span id="cb34-290"><a href="population-growth-on-multiple-sites.html#cb34-290" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-291"><a href="population-growth-on-multiple-sites.html#cb34-291" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-292"><a href="population-growth-on-multiple-sites.html#cb34-292" tabindex="-1"></a><span class="do">## [1] &quot;year 118 total 2093 with 43 sites ( F:3,HG:40 )&quot;</span></span>
<span id="cb34-293"><a href="population-growth-on-multiple-sites.html#cb34-293" tabindex="-1"></a><span class="do">## [1] &quot;year 119 total 2089 with 43 sites ( F:3,HG:40 )&quot;</span></span>
<span id="cb34-294"><a href="population-growth-on-multiple-sites.html#cb34-294" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-295"><a href="population-growth-on-multiple-sites.html#cb34-295" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-296"><a href="population-growth-on-multiple-sites.html#cb34-296" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-297"><a href="population-growth-on-multiple-sites.html#cb34-297" tabindex="-1"></a><span class="do">## [1] &quot;year 120 total 2096 with 43 sites ( F:3,HG:40 )&quot;</span></span>
<span id="cb34-298"><a href="population-growth-on-multiple-sites.html#cb34-298" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-299"><a href="population-growth-on-multiple-sites.html#cb34-299" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 54 and pop 8&quot;</span></span>
<span id="cb34-300"><a href="population-growth-on-multiple-sites.html#cb34-300" tabindex="-1"></a><span class="do">## [1] &quot;year 121 total 2105 with 44 sites ( F:3,HG:41 )&quot;</span></span>
<span id="cb34-301"><a href="population-growth-on-multiple-sites.html#cb34-301" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;15 migrant from F to F&quot;</span></span>
<span id="cb34-302"><a href="population-growth-on-multiple-sites.html#cb34-302" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-303"><a href="population-growth-on-multiple-sites.html#cb34-303" tabindex="-1"></a><span class="do">## [1] &quot;year 122 total 2104 with 44 sites ( F:3,HG:41 )&quot;</span></span>
<span id="cb34-304"><a href="population-growth-on-multiple-sites.html#cb34-304" tabindex="-1"></a><span class="do">## [1] &quot;year 123 total 2098 with 44 sites ( F:3,HG:41 )&quot;</span></span>
<span id="cb34-305"><a href="population-growth-on-multiple-sites.html#cb34-305" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 25 and pop 8&quot;</span></span>
<span id="cb34-306"><a href="population-growth-on-multiple-sites.html#cb34-306" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-307"><a href="population-growth-on-multiple-sites.html#cb34-307" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-308"><a href="population-growth-on-multiple-sites.html#cb34-308" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb34-309"><a href="population-growth-on-multiple-sites.html#cb34-309" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb34-310"><a href="population-growth-on-multiple-sites.html#cb34-310" tabindex="-1"></a><span class="do">## [1] &quot;year 124 total 2119 with 45 sites ( F:3,HG:42 )&quot;</span></span>
<span id="cb34-311"><a href="population-growth-on-multiple-sites.html#cb34-311" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 45 and pop 5&quot;</span></span>
<span id="cb34-312"><a href="population-growth-on-multiple-sites.html#cb34-312" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-313"><a href="population-growth-on-multiple-sites.html#cb34-313" tabindex="-1"></a><span class="do">## [1] &quot;year 125 total 2144 with 46 sites ( F:3,HG:43 )&quot;</span></span>
<span id="cb34-314"><a href="population-growth-on-multiple-sites.html#cb34-314" tabindex="-1"></a><span class="do">## [1] &quot;year 126 total 2137 with 46 sites ( F:3,HG:43 )&quot;</span></span>
<span id="cb34-315"><a href="population-growth-on-multiple-sites.html#cb34-315" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 45 and pop 6&quot;</span></span>
<span id="cb34-316"><a href="population-growth-on-multiple-sites.html#cb34-316" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 42 and pop 4&quot;</span></span>
<span id="cb34-317"><a href="population-growth-on-multiple-sites.html#cb34-317" tabindex="-1"></a><span class="do">## [1] &quot;year 127 total 2162 with 48 sites ( F:3,HG:45 )&quot;</span></span>
<span id="cb34-318"><a href="population-growth-on-multiple-sites.html#cb34-318" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-319"><a href="population-growth-on-multiple-sites.html#cb34-319" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb34-320"><a href="population-growth-on-multiple-sites.html#cb34-320" tabindex="-1"></a><span class="do">## [1] &quot;year 128 total 2164 with 48 sites ( F:3,HG:45 )&quot;</span></span>
<span id="cb34-321"><a href="population-growth-on-multiple-sites.html#cb34-321" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-322"><a href="population-growth-on-multiple-sites.html#cb34-322" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;17 migrant from F to F&quot;</span></span>
<span id="cb34-323"><a href="population-growth-on-multiple-sites.html#cb34-323" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-324"><a href="population-growth-on-multiple-sites.html#cb34-324" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-325"><a href="population-growth-on-multiple-sites.html#cb34-325" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb34-326"><a href="population-growth-on-multiple-sites.html#cb34-326" tabindex="-1"></a><span class="do">## [1] &quot;year 129 total 2165 with 48 sites ( F:3,HG:45 )&quot;</span></span>
<span id="cb34-327"><a href="population-growth-on-multiple-sites.html#cb34-327" tabindex="-1"></a><span class="do">## [1] &quot;year 130 total 2141 with 48 sites ( F:3,HG:45 )&quot;</span></span>
<span id="cb34-328"><a href="population-growth-on-multiple-sites.html#cb34-328" tabindex="-1"></a><span class="do">## [1] &quot;year 131 total 2116 with 48 sites ( F:3,HG:45 )&quot;</span></span>
<span id="cb34-329"><a href="population-growth-on-multiple-sites.html#cb34-329" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-330"><a href="population-growth-on-multiple-sites.html#cb34-330" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-331"><a href="population-growth-on-multiple-sites.html#cb34-331" tabindex="-1"></a><span class="do">## [1] &quot;year 132 total 2119 with 48 sites ( F:3,HG:45 )&quot;</span></span>
<span id="cb34-332"><a href="population-growth-on-multiple-sites.html#cb34-332" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-333"><a href="population-growth-on-multiple-sites.html#cb34-333" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;34 migrant from F to F&quot;</span></span>
<span id="cb34-334"><a href="population-growth-on-multiple-sites.html#cb34-334" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-335"><a href="population-growth-on-multiple-sites.html#cb34-335" tabindex="-1"></a><span class="do">## [1] &quot;year 133 total 2110 with 48 sites ( F:3,HG:45 )&quot;</span></span>
<span id="cb34-336"><a href="population-growth-on-multiple-sites.html#cb34-336" tabindex="-1"></a><span class="do">## [1] &quot;year 134 total 2125 with 48 sites ( F:3,HG:45 )&quot;</span></span>
<span id="cb34-337"><a href="population-growth-on-multiple-sites.html#cb34-337" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-338"><a href="population-growth-on-multiple-sites.html#cb34-338" tabindex="-1"></a><span class="do">## [1] &quot;year 135 total 2123 with 48 sites ( F:3,HG:45 )&quot;</span></span>
<span id="cb34-339"><a href="population-growth-on-multiple-sites.html#cb34-339" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;19 migrant from F to F&quot;</span></span>
<span id="cb34-340"><a href="population-growth-on-multiple-sites.html#cb34-340" tabindex="-1"></a><span class="do">## [1] &quot;year 136 total 2145 with 48 sites ( F:3,HG:45 )&quot;</span></span>
<span id="cb34-341"><a href="population-growth-on-multiple-sites.html#cb34-341" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-342"><a href="population-growth-on-multiple-sites.html#cb34-342" tabindex="-1"></a><span class="do">## [1] &quot;year 137 total 2149 with 48 sites ( F:3,HG:45 )&quot;</span></span>
<span id="cb34-343"><a href="population-growth-on-multiple-sites.html#cb34-343" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-344"><a href="population-growth-on-multiple-sites.html#cb34-344" tabindex="-1"></a><span class="do">## [1] &quot;year 138 total 2152 with 48 sites ( F:3,HG:45 )&quot;</span></span>
<span id="cb34-345"><a href="population-growth-on-multiple-sites.html#cb34-345" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-346"><a href="population-growth-on-multiple-sites.html#cb34-346" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-347"><a href="population-growth-on-multiple-sites.html#cb34-347" tabindex="-1"></a><span class="do">## [1] &quot;year 139 total 2187 with 48 sites ( F:3,HG:45 )&quot;</span></span>
<span id="cb34-348"><a href="population-growth-on-multiple-sites.html#cb34-348" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-349"><a href="population-growth-on-multiple-sites.html#cb34-349" tabindex="-1"></a><span class="do">## [1] &quot;year 140 total 2186 with 48 sites ( F:3,HG:45 )&quot;</span></span>
<span id="cb34-350"><a href="population-growth-on-multiple-sites.html#cb34-350" tabindex="-1"></a><span class="do">## [1] &quot;year 141 total 2200 with 48 sites ( F:3,HG:45 )&quot;</span></span>
<span id="cb34-351"><a href="population-growth-on-multiple-sites.html#cb34-351" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb34-352"><a href="population-growth-on-multiple-sites.html#cb34-352" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-353"><a href="population-growth-on-multiple-sites.html#cb34-353" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 34 and pop 5&quot;</span></span>
<span id="cb34-354"><a href="population-growth-on-multiple-sites.html#cb34-354" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;19 migrant from F to F&quot;</span></span>
<span id="cb34-355"><a href="population-growth-on-multiple-sites.html#cb34-355" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-356"><a href="population-growth-on-multiple-sites.html#cb34-356" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-357"><a href="population-growth-on-multiple-sites.html#cb34-357" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-358"><a href="population-growth-on-multiple-sites.html#cb34-358" tabindex="-1"></a><span class="do">## [1] &quot;year 142 total 2204 with 49 sites ( F:3,HG:46 )&quot;</span></span>
<span id="cb34-359"><a href="population-growth-on-multiple-sites.html#cb34-359" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-360"><a href="population-growth-on-multiple-sites.html#cb34-360" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;9 migrant from HG to HG&quot;</span></span>
<span id="cb34-361"><a href="population-growth-on-multiple-sites.html#cb34-361" tabindex="-1"></a><span class="do">## [1] &quot;year 143 total 2202 with 49 sites ( F:3,HG:46 )&quot;</span></span>
<span id="cb34-362"><a href="population-growth-on-multiple-sites.html#cb34-362" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-363"><a href="population-growth-on-multiple-sites.html#cb34-363" tabindex="-1"></a><span class="do">## [1] &quot;year 144 total 2224 with 49 sites ( F:3,HG:46 )&quot;</span></span>
<span id="cb34-364"><a href="population-growth-on-multiple-sites.html#cb34-364" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb34-365"><a href="population-growth-on-multiple-sites.html#cb34-365" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;2 migrant from HG to HG&quot;</span></span>
<span id="cb34-366"><a href="population-growth-on-multiple-sites.html#cb34-366" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-367"><a href="population-growth-on-multiple-sites.html#cb34-367" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-368"><a href="population-growth-on-multiple-sites.html#cb34-368" tabindex="-1"></a><span class="do">## [1] &quot;year 145 total 2225 with 49 sites ( F:3,HG:46 )&quot;</span></span>
<span id="cb34-369"><a href="population-growth-on-multiple-sites.html#cb34-369" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb34-370"><a href="population-growth-on-multiple-sites.html#cb34-370" tabindex="-1"></a><span class="do">## [1] &quot;year 146 total 2233 with 49 sites ( F:3,HG:46 )&quot;</span></span>
<span id="cb34-371"><a href="population-growth-on-multiple-sites.html#cb34-371" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-372"><a href="population-growth-on-multiple-sites.html#cb34-372" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb34-373"><a href="population-growth-on-multiple-sites.html#cb34-373" tabindex="-1"></a><span class="do">## [1] &quot;year 147 total 2226 with 49 sites ( F:3,HG:46 )&quot;</span></span>
<span id="cb34-374"><a href="population-growth-on-multiple-sites.html#cb34-374" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-375"><a href="population-growth-on-multiple-sites.html#cb34-375" tabindex="-1"></a><span class="do">## [1] &quot;year 148 total 2218 with 49 sites ( F:3,HG:46 )&quot;</span></span>
<span id="cb34-376"><a href="population-growth-on-multiple-sites.html#cb34-376" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-377"><a href="population-growth-on-multiple-sites.html#cb34-377" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb34-378"><a href="population-growth-on-multiple-sites.html#cb34-378" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-379"><a href="population-growth-on-multiple-sites.html#cb34-379" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 29 and pop 5&quot;</span></span>
<span id="cb34-380"><a href="population-growth-on-multiple-sites.html#cb34-380" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-381"><a href="population-growth-on-multiple-sites.html#cb34-381" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb34-382"><a href="population-growth-on-multiple-sites.html#cb34-382" tabindex="-1"></a><span class="do">## [1] &quot;year 149 total 2225 with 50 sites ( F:3,HG:47 )&quot;</span></span>
<span id="cb34-383"><a href="population-growth-on-multiple-sites.html#cb34-383" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;2 migrant from HG to HG&quot;</span></span>
<span id="cb34-384"><a href="population-growth-on-multiple-sites.html#cb34-384" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb34-385"><a href="population-growth-on-multiple-sites.html#cb34-385" tabindex="-1"></a><span class="do">## [1] &quot;year 150 total 2249 with 50 sites ( F:3,HG:47 )&quot;</span></span>
<span id="cb34-386"><a href="population-growth-on-multiple-sites.html#cb34-386" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-387"><a href="population-growth-on-multiple-sites.html#cb34-387" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb34-388"><a href="population-growth-on-multiple-sites.html#cb34-388" tabindex="-1"></a><span class="do">## [1] &quot;year 151 total 2253 with 50 sites ( F:3,HG:47 )&quot;</span></span>
<span id="cb34-389"><a href="population-growth-on-multiple-sites.html#cb34-389" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb34-390"><a href="population-growth-on-multiple-sites.html#cb34-390" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;11 migrant from F to F&quot;</span></span>
<span id="cb34-391"><a href="population-growth-on-multiple-sites.html#cb34-391" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 32 and pop 5&quot;</span></span></code></pre></div>
Check the code of the simulation functions here:
<details>
<summary>
Show code
</summary>
<p><strong>Code</strong></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="population-growth-on-multiple-sites.html#cb35-1" tabindex="-1"></a><span class="do">## Function 17. Change population sizes</span></span>
<span id="cb35-2"><a href="population-growth-on-multiple-sites.html#cb35-2" tabindex="-1"></a>changePopSize <span class="ot">&lt;-</span> <span class="cf">function</span>(loosingPop, size, <span class="at">winingPop=</span><span class="cn">NULL</span>, <span class="at">new=</span>F,</span>
<span id="cb35-3"><a href="population-growth-on-multiple-sites.html#cb35-3" tabindex="-1"></a>                          <span class="at">method=</span><span class="st">&quot;random&quot;</span>, <span class="at">probs=</span>dnorm,</span>
<span id="cb35-4"><a href="population-growth-on-multiple-sites.html#cb35-4" tabindex="-1"></a>                          <span class="at">prob.option=</span><span class="fu">list</span>(<span class="st">&quot;sd&quot;</span><span class="ot">=</span><span class="dv">10</span>, <span class="st">&quot;mean&quot;</span><span class="ot">=</span><span class="dv">22</span>)) {</span>
<span id="cb35-5"><a href="population-growth-on-multiple-sites.html#cb35-5" tabindex="-1"></a>  <span class="co">#print(dim(loosingPop))</span></span>
<span id="cb35-6"><a href="population-growth-on-multiple-sites.html#cb35-6" tabindex="-1"></a>  <span class="co">#if(!is.null(winingPop))</span></span>
<span id="cb35-7"><a href="population-growth-on-multiple-sites.html#cb35-7" tabindex="-1"></a>  <span class="co">#    print(dim(winingPop))</span></span>
<span id="cb35-8"><a href="population-growth-on-multiple-sites.html#cb35-8" tabindex="-1"></a>  <span class="co">#if(length(size)==0 || size==0)return(data.frame(Age=numeric(),Sex=character()))</span></span>
<span id="cb35-9"><a href="population-growth-on-multiple-sites.html#cb35-9" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(loosingPop)<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb35-10"><a href="population-growth-on-multiple-sites.html#cb35-10" tabindex="-1"></a>    kill <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb35-11"><a href="population-growth-on-multiple-sites.html#cb35-11" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span>(method<span class="sc">==</span><span class="st">&quot;random&quot;</span>){</span>
<span id="cb35-12"><a href="population-growth-on-multiple-sites.html#cb35-12" tabindex="-1"></a>    kill <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(</span>
<span id="cb35-13"><a href="population-growth-on-multiple-sites.html#cb35-13" tabindex="-1"></a>      <span class="fu">sample</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(loosingPop), <span class="at">size=</span>size,</span>
<span id="cb35-14"><a href="population-growth-on-multiple-sites.html#cb35-14" tabindex="-1"></a>             <span class="at">prob=</span><span class="fu">probs</span>(loosingPop<span class="sc">$</span>Age, <span class="at">mean=</span>prob.option<span class="sc">$</span>mean, <span class="at">sd=</span>prob.option<span class="sc">$</span>sd)),</span>
<span id="cb35-15"><a href="population-growth-on-multiple-sites.html#cb35-15" tabindex="-1"></a>      <span class="at">error=</span><span class="cf">function</span>(e){</span>
<span id="cb35-16"><a href="population-growth-on-multiple-sites.html#cb35-16" tabindex="-1"></a>        <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;problem with population replacement for settlement of size:&quot;</span>,</span>
<span id="cb35-17"><a href="population-growth-on-multiple-sites.html#cb35-17" tabindex="-1"></a>                     <span class="fu">nrow</span>(loosingPop), <span class="st">&quot; need to loose &quot;</span>, size));<span class="dv">0</span></span>
<span id="cb35-18"><a href="population-growth-on-multiple-sites.html#cb35-18" tabindex="-1"></a>        }</span>
<span id="cb35-19"><a href="population-growth-on-multiple-sites.html#cb35-19" tabindex="-1"></a>      )</span>
<span id="cb35-20"><a href="population-growth-on-multiple-sites.html#cb35-20" tabindex="-1"></a>  }</span>
<span id="cb35-21"><a href="population-growth-on-multiple-sites.html#cb35-21" tabindex="-1"></a>  <span class="co">#print(paste(&quot;diff&quot;,nrow(popdistrib)-size,&quot;new&quot;,size))</span></span>
<span id="cb35-22"><a href="population-growth-on-multiple-sites.html#cb35-22" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(winingPop)){</span>
<span id="cb35-23"><a href="population-growth-on-multiple-sites.html#cb35-23" tabindex="-1"></a>    winingPop <span class="ot">&lt;-</span> <span class="fu">rbind</span>(winingPop, loosingPop[kill,])</span>
<span id="cb35-24"><a href="population-growth-on-multiple-sites.html#cb35-24" tabindex="-1"></a>  }</span>
<span id="cb35-25"><a href="population-growth-on-multiple-sites.html#cb35-25" tabindex="-1"></a>  loosingPop <span class="ot">&lt;-</span> loosingPop[<span class="sc">-</span>kill,]</span>
<span id="cb35-26"><a href="population-growth-on-multiple-sites.html#cb35-26" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(winingPop))</span>
<span id="cb35-27"><a href="population-growth-on-multiple-sites.html#cb35-27" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(loosingPop, winingPop))</span>
<span id="cb35-28"><a href="population-growth-on-multiple-sites.html#cb35-28" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb35-29"><a href="population-growth-on-multiple-sites.html#cb35-29" tabindex="-1"></a>    <span class="fu">return</span>(loosingPop)</span>
<span id="cb35-30"><a href="population-growth-on-multiple-sites.html#cb35-30" tabindex="-1"></a>  </span>
<span id="cb35-31"><a href="population-growth-on-multiple-sites.html#cb35-31" tabindex="-1"></a>}</span>
<span id="cb35-32"><a href="population-growth-on-multiple-sites.html#cb35-32" tabindex="-1"></a></span>
<span id="cb35-33"><a href="population-growth-on-multiple-sites.html#cb35-33" tabindex="-1"></a></span>
<span id="cb35-34"><a href="population-growth-on-multiple-sites.html#cb35-34" tabindex="-1"></a><span class="do">## Function 18. Check sites touching</span></span>
<span id="cb35-35"><a href="population-growth-on-multiple-sites.html#cb35-35" tabindex="-1"></a>whotouch <span class="ot">&lt;-</span> <span class="cf">function</span>(i, sites, Ne, <span class="at">homophily=</span>F, <span class="at">buffersize=</span><span class="dv">200</span>){</span>
<span id="cb35-36"><a href="population-growth-on-multiple-sites.html#cb35-36" tabindex="-1"></a>  touch <span class="ot">&lt;-</span> <span class="fu">st_intersects</span>(</span>
<span id="cb35-37"><a href="population-growth-on-multiple-sites.html#cb35-37" tabindex="-1"></a>    <span class="fu">st_make_valid</span>(<span class="fu">st_as_sf</span>(<span class="fu">buffer</span>(sites[i], Ne[i] <span class="sc">*</span> buffersize))),</span>
<span id="cb35-38"><a href="population-growth-on-multiple-sites.html#cb35-38" tabindex="-1"></a>    <span class="fu">st_make_valid</span>(<span class="fu">st_as_sf</span>(<span class="fu">buffer</span>(sites, Ne <span class="sc">*</span> buffersize))))</span>
<span id="cb35-39"><a href="population-growth-on-multiple-sites.html#cb35-39" tabindex="-1"></a>  <span class="cf">if</span>( <span class="fu">length</span>(touch) <span class="sc">&gt;</span> <span class="dv">0</span> ){</span>
<span id="cb35-40"><a href="population-growth-on-multiple-sites.html#cb35-40" tabindex="-1"></a>    enemies <span class="ot">&lt;-</span> <span class="fu">unlist</span>(touch)</span>
<span id="cb35-41"><a href="population-growth-on-multiple-sites.html#cb35-41" tabindex="-1"></a>    <span class="cf">if</span>(homophily){</span>
<span id="cb35-42"><a href="population-growth-on-multiple-sites.html#cb35-42" tabindex="-1"></a>      enemies <span class="ot">&lt;-</span> enemies[enemies <span class="sc">!=</span> i]</span>
<span id="cb35-43"><a href="population-growth-on-multiple-sites.html#cb35-43" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb35-44"><a href="population-growth-on-multiple-sites.html#cb35-44" tabindex="-1"></a>      enemies <span class="ot">&lt;-</span> enemies[sites<span class="sc">$</span>culture[enemies] <span class="sc">!=</span> sites<span class="sc">$</span>culture[i]]</span>
<span id="cb35-45"><a href="population-growth-on-multiple-sites.html#cb35-45" tabindex="-1"></a>    }</span>
<span id="cb35-46"><a href="population-growth-on-multiple-sites.html#cb35-46" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb35-47"><a href="population-growth-on-multiple-sites.html#cb35-47" tabindex="-1"></a>    enemies <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb35-48"><a href="population-growth-on-multiple-sites.html#cb35-48" tabindex="-1"></a>  }</span>
<span id="cb35-49"><a href="population-growth-on-multiple-sites.html#cb35-49" tabindex="-1"></a>  <span class="fu">return</span>(enemies)</span>
<span id="cb35-50"><a href="population-growth-on-multiple-sites.html#cb35-50" tabindex="-1"></a>}</span>
<span id="cb35-51"><a href="population-growth-on-multiple-sites.html#cb35-51" tabindex="-1"></a></span>
<span id="cb35-52"><a href="population-growth-on-multiple-sites.html#cb35-52" tabindex="-1"></a></span>
<span id="cb35-53"><a href="population-growth-on-multiple-sites.html#cb35-53" tabindex="-1"></a><span class="do">## Function 19. Model a simple fight</span></span>
<span id="cb35-54"><a href="population-growth-on-multiple-sites.html#cb35-54" tabindex="-1"></a>simplefight <span class="ot">&lt;-</span> <span class="cf">function</span>(Ne, a, b){</span>
<span id="cb35-55"><a href="population-growth-on-multiple-sites.html#cb35-55" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> Ne[a] <span class="sc">/</span> (Ne[a] <span class="sc">+</span> Ne[b])){</span>
<span id="cb35-56"><a href="population-growth-on-multiple-sites.html#cb35-56" tabindex="-1"></a>    v <span class="ot">&lt;-</span> a</span>
<span id="cb35-57"><a href="population-growth-on-multiple-sites.html#cb35-57" tabindex="-1"></a>    l <span class="ot">&lt;-</span> b</span>
<span id="cb35-58"><a href="population-growth-on-multiple-sites.html#cb35-58" tabindex="-1"></a>  }</span>
<span id="cb35-59"><a href="population-growth-on-multiple-sites.html#cb35-59" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb35-60"><a href="population-growth-on-multiple-sites.html#cb35-60" tabindex="-1"></a>    v <span class="ot">&lt;-</span> b</span>
<span id="cb35-61"><a href="population-growth-on-multiple-sites.html#cb35-61" tabindex="-1"></a>    l <span class="ot">&lt;-</span> a</span>
<span id="cb35-62"><a href="population-growth-on-multiple-sites.html#cb35-62" tabindex="-1"></a>  }</span>
<span id="cb35-63"><a href="population-growth-on-multiple-sites.html#cb35-63" tabindex="-1"></a>  <span class="co"># Keep the original pop sizes for reporting outcome</span></span>
<span id="cb35-64"><a href="population-growth-on-multiple-sites.html#cb35-64" tabindex="-1"></a>  one <span class="ot">&lt;-</span> Ne</span>
<span id="cb35-65"><a href="population-growth-on-multiple-sites.html#cb35-65" tabindex="-1"></a>  <span class="co"># Update population sizes using a binomial</span></span>
<span id="cb35-66"><a href="population-growth-on-multiple-sites.html#cb35-66" tabindex="-1"></a>  Ne[v] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">prob=</span><span class="fl">0.9</span>, <span class="at">size=</span>Ne[v])</span>
<span id="cb35-67"><a href="population-growth-on-multiple-sites.html#cb35-67" tabindex="-1"></a>  Ne[l] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">prob=</span><span class="fl">0.4</span>, <span class="at">size=</span>Ne[l])</span>
<span id="cb35-68"><a href="population-growth-on-multiple-sites.html#cb35-68" tabindex="-1"></a>  <span class="fu">print</span>(</span>
<span id="cb35-69"><a href="population-growth-on-multiple-sites.html#cb35-69" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="st">&quot;victory&quot;</span>, v, <span class="st">&quot;(&quot;</span>, one[v], <span class="st">&quot;-&quot;</span>, Ne[v],<span class="st">&quot;) over&quot;</span>, l, </span>
<span id="cb35-70"><a href="population-growth-on-multiple-sites.html#cb35-70" tabindex="-1"></a>          <span class="st">&quot;(&quot;</span>,one[l],<span class="st">&quot;-&quot;</span>,Ne[l],<span class="st">&quot;), total of: &quot;</span>, (one[v]<span class="sc">-</span>Ne[v]) <span class="sc">+</span> (one[l]<span class="sc">-</span>Ne[l]), <span class="st">&quot;people&quot;</span>))</span>
<span id="cb35-71"><a href="population-growth-on-multiple-sites.html#cb35-71" tabindex="-1"></a>  <span class="fu">return</span>(Ne)</span>
<span id="cb35-72"><a href="population-growth-on-multiple-sites.html#cb35-72" tabindex="-1"></a>}   </span>
<span id="cb35-73"><a href="population-growth-on-multiple-sites.html#cb35-73" tabindex="-1"></a></span>
<span id="cb35-74"><a href="population-growth-on-multiple-sites.html#cb35-74" tabindex="-1"></a></span>
<span id="cb35-75"><a href="population-growth-on-multiple-sites.html#cb35-75" tabindex="-1"></a><span class="do">## Function 20. Model fight with better probabilities</span></span>
<span id="cb35-76"><a href="population-growth-on-multiple-sites.html#cb35-76" tabindex="-1"></a>fightbetterloss <span class="ot">&lt;-</span> <span class="cf">function</span>(Ne,a,b){</span>
<span id="cb35-77"><a href="population-growth-on-multiple-sites.html#cb35-77" tabindex="-1"></a>  <span class="cf">if</span>( <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> Ne[a]<span class="sc">/</span>(Ne[a] <span class="sc">+</span> Ne[b]) ){</span>
<span id="cb35-78"><a href="population-growth-on-multiple-sites.html#cb35-78" tabindex="-1"></a>    v <span class="ot">&lt;-</span> a</span>
<span id="cb35-79"><a href="population-growth-on-multiple-sites.html#cb35-79" tabindex="-1"></a>    l <span class="ot">&lt;-</span> b</span>
<span id="cb35-80"><a href="population-growth-on-multiple-sites.html#cb35-80" tabindex="-1"></a>  }</span>
<span id="cb35-81"><a href="population-growth-on-multiple-sites.html#cb35-81" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb35-82"><a href="population-growth-on-multiple-sites.html#cb35-82" tabindex="-1"></a>    v <span class="ot">&lt;-</span> b</span>
<span id="cb35-83"><a href="population-growth-on-multiple-sites.html#cb35-83" tabindex="-1"></a>    l <span class="ot">&lt;-</span> a</span>
<span id="cb35-84"><a href="population-growth-on-multiple-sites.html#cb35-84" tabindex="-1"></a>  }</span>
<span id="cb35-85"><a href="population-growth-on-multiple-sites.html#cb35-85" tabindex="-1"></a>  one <span class="ot">&lt;-</span> Ne</span>
<span id="cb35-86"><a href="population-growth-on-multiple-sites.html#cb35-86" tabindex="-1"></a>  Ne[v] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">prob=</span><span class="dv">1</span> <span class="sc">-</span> Ne[l]<span class="sc">/</span>(Ne[v] <span class="sc">+</span> Ne[l]), <span class="at">size=</span>Ne[v])</span>
<span id="cb35-87"><a href="population-growth-on-multiple-sites.html#cb35-87" tabindex="-1"></a>  Ne[l] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">prob=</span><span class="dv">1</span> <span class="sc">-</span> Ne[v]<span class="sc">/</span>(Ne[v] <span class="sc">+</span> Ne[l]), <span class="at">size=</span>Ne[l])</span>
<span id="cb35-88"><a href="population-growth-on-multiple-sites.html#cb35-88" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;victory &quot;</span>, v, <span class="st">&quot;(&quot;</span>, one[v], <span class="st">&quot;-&quot;</span>, Ne[v],<span class="st">&quot;) over &quot;</span>, l,</span>
<span id="cb35-89"><a href="population-growth-on-multiple-sites.html#cb35-89" tabindex="-1"></a>               <span class="st">&quot; (&quot;</span>, one[l], <span class="st">&quot;-&quot;</span>, Ne[l], <span class="st">&quot;), tot: &quot;</span>, (one[v]<span class="sc">-</span>Ne[v]) <span class="sc">+</span> (one[l]<span class="sc">-</span>Ne[l]), <span class="st">&quot;losses&quot;</span>))</span>
<span id="cb35-90"><a href="population-growth-on-multiple-sites.html#cb35-90" tabindex="-1"></a>  <span class="fu">return</span>(Ne)</span>
<span id="cb35-91"><a href="population-growth-on-multiple-sites.html#cb35-91" tabindex="-1"></a>}   </span>
<span id="cb35-92"><a href="population-growth-on-multiple-sites.html#cb35-92" tabindex="-1"></a></span>
<span id="cb35-93"><a href="population-growth-on-multiple-sites.html#cb35-93" tabindex="-1"></a></span>
<span id="cb35-94"><a href="population-growth-on-multiple-sites.html#cb35-94" tabindex="-1"></a><span class="do">## Function 21. Draw a war symbol where two clans are fighting</span></span>
<span id="cb35-95"><a href="population-growth-on-multiple-sites.html#cb35-95" tabindex="-1"></a>warpoints <span class="ot">&lt;-</span> <span class="cf">function</span>(sites, a, b, Ne, <span class="at">buffersize=</span><span class="dv">300</span>, <span class="at">plot=</span>T, <span class="at">sizewar=</span><span class="dv">2</span>){</span>
<span id="cb35-96"><a href="population-growth-on-multiple-sites.html#cb35-96" tabindex="-1"></a>  meetpoints <span class="ot">&lt;-</span> <span class="fu">crop</span>(</span>
<span id="cb35-97"><a href="population-growth-on-multiple-sites.html#cb35-97" tabindex="-1"></a>    <span class="fu">buffer</span>(sites[a], <span class="dv">1</span><span class="sc">+</span>Ne[a] <span class="sc">*</span> buffersize),</span>
<span id="cb35-98"><a href="population-growth-on-multiple-sites.html#cb35-98" tabindex="-1"></a>    <span class="fu">buffer</span>(sites[b], <span class="dv">1</span><span class="sc">+</span>Ne[b] <span class="sc">*</span> buffersize)</span>
<span id="cb35-99"><a href="population-growth-on-multiple-sites.html#cb35-99" tabindex="-1"></a>  )</span>
<span id="cb35-100"><a href="population-growth-on-multiple-sites.html#cb35-100" tabindex="-1"></a>  <span class="cf">if</span>( <span class="fu">length</span>(meetpoints)<span class="sc">&gt;</span><span class="dv">0</span> ){</span>
<span id="cb35-101"><a href="population-growth-on-multiple-sites.html#cb35-101" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">spatSample</span>(meetpoints, <span class="dv">1</span>)</span>
<span id="cb35-102"><a href="population-growth-on-multiple-sites.html#cb35-102" tabindex="-1"></a>    <span class="cf">if</span>(plot <span class="sc">&amp;</span> <span class="fu">length</span>(p)<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb35-103"><a href="population-growth-on-multiple-sites.html#cb35-103" tabindex="-1"></a>      <span class="fu">plot</span>(p, <span class="at">add=</span>T, <span class="at">bg=</span><span class="st">&quot;red&quot;</span>, <span class="at">pch=</span><span class="st">&quot;🔥&quot;</span>, <span class="at">cex=</span>sizewar,</span>
<span id="cb35-104"><a href="population-growth-on-multiple-sites.html#cb35-104" tabindex="-1"></a>           <span class="at">col=</span><span class="fu">adjustcolor</span>(<span class="st">&quot;yellow&quot;</span>, <span class="fl">0.1</span>))</span>
<span id="cb35-105"><a href="population-growth-on-multiple-sites.html#cb35-105" tabindex="-1"></a>      <span class="fu">plot</span>(p, <span class="at">add=</span>T, <span class="at">bg=</span><span class="st">&quot;yellow&quot;</span>, <span class="at">pch=</span><span class="st">&quot;⚔️&quot;</span> ,<span class="at">cex=</span>sizewar)</span>
<span id="cb35-106"><a href="population-growth-on-multiple-sites.html#cb35-106" tabindex="-1"></a>    }</span>
<span id="cb35-107"><a href="population-growth-on-multiple-sites.html#cb35-107" tabindex="-1"></a>    <span class="fu">return</span>(p)</span>
<span id="cb35-108"><a href="population-growth-on-multiple-sites.html#cb35-108" tabindex="-1"></a>  }</span>
<span id="cb35-109"><a href="population-growth-on-multiple-sites.html#cb35-109" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb35-110"><a href="population-growth-on-multiple-sites.html#cb35-110" tabindex="-1"></a>}</span>
<span id="cb35-111"><a href="population-growth-on-multiple-sites.html#cb35-111" tabindex="-1"></a></span>
<span id="cb35-112"><a href="population-growth-on-multiple-sites.html#cb35-112" tabindex="-1"></a></span>
<span id="cb35-113"><a href="population-growth-on-multiple-sites.html#cb35-113" tabindex="-1"></a></span>
<span id="cb35-114"><a href="population-growth-on-multiple-sites.html#cb35-114" tabindex="-1"></a><span class="do">## Function 22. Run simulation</span></span>
<span id="cb35-115"><a href="population-growth-on-multiple-sites.html#cb35-115" tabindex="-1"></a>run_simulation <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">cultures=</span><span class="cn">NULL</span>,</span>
<span id="cb35-116"><a href="population-growth-on-multiple-sites.html#cb35-116" tabindex="-1"></a>                           <span class="at">viable=</span><span class="cn">NULL</span>,</span>
<span id="cb35-117"><a href="population-growth-on-multiple-sites.html#cb35-117" tabindex="-1"></a>                           <span class="at">sites=</span><span class="cn">NULL</span>,</span>
<span id="cb35-118"><a href="population-growth-on-multiple-sites.html#cb35-118" tabindex="-1"></a>                           <span class="at">dem=</span><span class="cn">NULL</span>,</span>
<span id="cb35-119"><a href="population-growth-on-multiple-sites.html#cb35-119" tabindex="-1"></a>                           <span class="at">ressources=</span><span class="cn">NULL</span>,</span>
<span id="cb35-120"><a href="population-growth-on-multiple-sites.html#cb35-120" tabindex="-1"></a>                           <span class="at">water=</span><span class="cn">NULL</span>,</span>
<span id="cb35-121"><a href="population-growth-on-multiple-sites.html#cb35-121" tabindex="-1"></a>                           <span class="at">foldervid=</span><span class="st">&quot;pathtofinal&quot;</span>,</span>
<span id="cb35-122"><a href="population-growth-on-multiple-sites.html#cb35-122" tabindex="-1"></a>                           <span class="at">visu=</span><span class="cn">FALSE</span>,</span>
<span id="cb35-123"><a href="population-growth-on-multiple-sites.html#cb35-123" tabindex="-1"></a>                           <span class="at">visumin=</span><span class="cn">TRUE</span>,</span>
<span id="cb35-124"><a href="population-growth-on-multiple-sites.html#cb35-124" tabindex="-1"></a>                           <span class="at">ts=</span><span class="dv">20000</span>,</span>
<span id="cb35-125"><a href="population-growth-on-multiple-sites.html#cb35-125" tabindex="-1"></a>                           <span class="at">Kbase=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="dv">35</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="dv">120</span>),</span>
<span id="cb35-126"><a href="population-growth-on-multiple-sites.html#cb35-126" tabindex="-1"></a>                           <span class="at">cul_ext=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="dv">7</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="dv">6</span>),</span>
<span id="cb35-127"><a href="population-growth-on-multiple-sites.html#cb35-127" tabindex="-1"></a>                           <span class="at">penal_cul=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="dv">4</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="dv">5</span>),</span>
<span id="cb35-128"><a href="population-growth-on-multiple-sites.html#cb35-128" tabindex="-1"></a>                           <span class="at">prob_birth=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="fl">0.3</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.5</span>),</span>
<span id="cb35-129"><a href="population-growth-on-multiple-sites.html#cb35-129" tabindex="-1"></a>                           <span class="at">prob_survive=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="fl">0.8</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.6</span>),</span>
<span id="cb35-130"><a href="population-growth-on-multiple-sites.html#cb35-130" tabindex="-1"></a>                           <span class="at">prob_split=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span> .<span class="dv">2</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.6</span>),</span>
<span id="cb35-131"><a href="population-growth-on-multiple-sites.html#cb35-131" tabindex="-1"></a>                           <span class="at">prob_move=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="fl">0.2</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.1</span>),</span>
<span id="cb35-132"><a href="population-growth-on-multiple-sites.html#cb35-132" tabindex="-1"></a>                           <span class="at">minimals=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span>.<span class="dv">14</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span>.<span class="dv">20</span>), </span>
<span id="cb35-133"><a href="population-growth-on-multiple-sites.html#cb35-133" tabindex="-1"></a>                           <span class="at">bufferatack=</span><span class="dv">400</span>,</span>
<span id="cb35-134"><a href="population-growth-on-multiple-sites.html#cb35-134" tabindex="-1"></a>                           <span class="at">buffersettl=</span><span class="dv">2000</span>,</span>
<span id="cb35-135"><a href="population-growth-on-multiple-sites.html#cb35-135" tabindex="-1"></a>                           <span class="at">Nts=</span><span class="cn">NULL</span>,</span>
<span id="cb35-136"><a href="population-growth-on-multiple-sites.html#cb35-136" tabindex="-1"></a>                           <span class="at">Ips=</span><span class="cn">NULL</span></span>
<span id="cb35-137"><a href="population-growth-on-multiple-sites.html#cb35-137" tabindex="-1"></a>){</span>
<span id="cb35-138"><a href="population-growth-on-multiple-sites.html#cb35-138" tabindex="-1"></a>  <span class="do">## Run stochastic process  </span></span>
<span id="cb35-139"><a href="population-growth-on-multiple-sites.html#cb35-139" tabindex="-1"></a>  </span>
<span id="cb35-140"><a href="population-growth-on-multiple-sites.html#cb35-140" tabindex="-1"></a>  Ks <span class="ot">&lt;-</span> sites<span class="sc">$</span>Ks</span>
<span id="cb35-141"><a href="population-growth-on-multiple-sites.html#cb35-141" tabindex="-1"></a>  cultures <span class="ot">&lt;-</span> sites<span class="sc">$</span>culture</span>
<span id="cb35-142"><a href="population-growth-on-multiple-sites.html#cb35-142" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(Nts)){ </span>
<span id="cb35-143"><a href="population-growth-on-multiple-sites.html#cb35-143" tabindex="-1"></a>    INs <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="fu">length</span>(sites), <span class="fl">0.85</span>, <span class="fl">0.95</span>) <span class="sc">*</span> sites<span class="sc">$</span>Ks) <span class="co">#Population size at initialisation</span></span>
<span id="cb35-144"><a href="population-growth-on-multiple-sites.html#cb35-144" tabindex="-1"></a>    Ips <span class="ot">&lt;-</span> <span class="fu">lapply</span>(INs, initpopstruc) <span class="co">#initialise population structure for all sites</span></span>
<span id="cb35-145"><a href="population-growth-on-multiple-sites.html#cb35-145" tabindex="-1"></a>    Nts <span class="ot">&lt;-</span> <span class="fu">initlistsites</span>(Ips, <span class="at">ts=</span>ts)</span>
<span id="cb35-146"><a href="population-growth-on-multiple-sites.html#cb35-146" tabindex="-1"></a>    frame <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb35-147"><a href="population-growth-on-multiple-sites.html#cb35-147" tabindex="-1"></a>    mint <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb35-148"><a href="population-growth-on-multiple-sites.html#cb35-148" tabindex="-1"></a>  } <span class="cf">else</span> {<span class="do">##should check and test howto start back a simulation</span></span>
<span id="cb35-149"><a href="population-growth-on-multiple-sites.html#cb35-149" tabindex="-1"></a>    mint <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Nts) </span>
<span id="cb35-150"><a href="population-growth-on-multiple-sites.html#cb35-150" tabindex="-1"></a>    frame <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Nts) </span>
<span id="cb35-151"><a href="population-growth-on-multiple-sites.html#cb35-151" tabindex="-1"></a>  }</span>
<span id="cb35-152"><a href="population-growth-on-multiple-sites.html#cb35-152" tabindex="-1"></a>  </span>
<span id="cb35-153"><a href="population-growth-on-multiple-sites.html#cb35-153" tabindex="-1"></a>  <span class="do">### visualisation =====</span></span>
<span id="cb35-154"><a href="population-growth-on-multiple-sites.html#cb35-154" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(foldervid) <span class="sc">&amp;</span> visu){</span>
<span id="cb35-155"><a href="population-growth-on-multiple-sites.html#cb35-155" tabindex="-1"></a>    <span class="fu">dir.create</span>(foldervid)</span>
<span id="cb35-156"><a href="population-growth-on-multiple-sites.html#cb35-156" tabindex="-1"></a>  }</span>
<span id="cb35-157"><a href="population-growth-on-multiple-sites.html#cb35-157" tabindex="-1"></a>  <span class="do">###</span></span>
<span id="cb35-158"><a href="population-growth-on-multiple-sites.html#cb35-158" tabindex="-1"></a>  </span>
<span id="cb35-159"><a href="population-growth-on-multiple-sites.html#cb35-159" tabindex="-1"></a>  warcasualties <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;integer&quot;</span>, ts)</span>
<span id="cb35-160"><a href="population-growth-on-multiple-sites.html#cb35-160" tabindex="-1"></a>  </span>
<span id="cb35-161"><a href="population-growth-on-multiple-sites.html#cb35-161" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(ts<span class="sc">+</span><span class="dv">1</span>)){</span>
<span id="cb35-162"><a href="population-growth-on-multiple-sites.html#cb35-162" tabindex="-1"></a>    countcult <span class="ot">&lt;-</span> <span class="fu">table</span>(sites<span class="sc">$</span>culture[Nts[i<span class="dv">-1</span>, ] <span class="sc">&gt;</span> <span class="dv">0</span>])</span>
<span id="cb35-163"><a href="population-growth-on-multiple-sites.html#cb35-163" tabindex="-1"></a>    <span class="cf">if</span> ( <span class="fu">length</span>(countcult) <span class="sc">!=</span> <span class="dv">2</span> ) {</span>
<span id="cb35-164"><a href="population-growth-on-multiple-sites.html#cb35-164" tabindex="-1"></a>      <span class="fu">return</span>(</span>
<span id="cb35-165"><a href="population-growth-on-multiple-sites.html#cb35-165" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">Nts=</span>Nts[,<span class="dv">1</span><span class="sc">:</span>i], </span>
<span id="cb35-166"><a href="population-growth-on-multiple-sites.html#cb35-166" tabindex="-1"></a>             <span class="at">warcasualties=</span>warcasualties[<span class="dv">1</span><span class="sc">:</span>i],</span>
<span id="cb35-167"><a href="population-growth-on-multiple-sites.html#cb35-167" tabindex="-1"></a>             <span class="at">Ips=</span>Ips,</span>
<span id="cb35-168"><a href="population-growth-on-multiple-sites.html#cb35-168" tabindex="-1"></a>             <span class="at">sites=</span>sites</span>
<span id="cb35-169"><a href="population-growth-on-multiple-sites.html#cb35-169" tabindex="-1"></a>        )</span>
<span id="cb35-170"><a href="population-growth-on-multiple-sites.html#cb35-170" tabindex="-1"></a>      )</span>
<span id="cb35-171"><a href="population-growth-on-multiple-sites.html#cb35-171" tabindex="-1"></a>    }</span>
<span id="cb35-172"><a href="population-growth-on-multiple-sites.html#cb35-172" tabindex="-1"></a>    <span class="fu">print</span>(</span>
<span id="cb35-173"><a href="population-growth-on-multiple-sites.html#cb35-173" tabindex="-1"></a>      <span class="fu">paste</span>(<span class="st">&quot;year&quot;</span>, i, <span class="st">&quot;total&quot;</span>, <span class="fu">sum</span>(<span class="fu">sapply</span>(Ips,nrow)),</span>
<span id="cb35-174"><a href="population-growth-on-multiple-sites.html#cb35-174" tabindex="-1"></a>            <span class="st">&quot;with&quot;</span>, <span class="fu">length</span>(sites), <span class="st">&quot;sites (&quot;</span>, </span>
<span id="cb35-175"><a href="population-growth-on-multiple-sites.html#cb35-175" tabindex="-1"></a>            <span class="fu">paste0</span>(<span class="fu">paste</span>(<span class="fu">names</span>(countcult), countcult, <span class="at">sep=</span><span class="st">&quot;:&quot;</span>), <span class="at">collapse=</span><span class="st">&quot;,&quot;</span>), <span class="st">&quot;)&quot;</span>))</span>
<span id="cb35-176"><a href="population-growth-on-multiple-sites.html#cb35-176" tabindex="-1"></a>    <span class="cf">if</span> (visumin){</span>
<span id="cb35-177"><a href="population-growth-on-multiple-sites.html#cb35-177" tabindex="-1"></a>      <span class="do">### visualisation =====</span></span>
<span id="cb35-178"><a href="population-growth-on-multiple-sites.html#cb35-178" tabindex="-1"></a>      frame <span class="ot">&lt;-</span> frame<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb35-179"><a href="population-growth-on-multiple-sites.html#cb35-179" tabindex="-1"></a>      filename <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;map_%06d.png&quot;</span>, frame)</span>
<span id="cb35-180"><a href="population-growth-on-multiple-sites.html#cb35-180" tabindex="-1"></a>      <span class="fu">png</span>(<span class="fu">file.path</span>(foldervid,filename), <span class="at">width=</span><span class="dv">800</span>, <span class="at">height=</span><span class="dv">800</span>, <span class="at">pointsize=</span><span class="dv">20</span>)</span>
<span id="cb35-181"><a href="population-growth-on-multiple-sites.html#cb35-181" tabindex="-1"></a>      <span class="fu">plotMap</span>(dem, water, <span class="fu">paste0</span>(<span class="st">&quot;year &quot;</span>,i))</span>
<span id="cb35-182"><a href="population-growth-on-multiple-sites.html#cb35-182" tabindex="-1"></a>      <span class="do">########</span></span>
<span id="cb35-183"><a href="population-growth-on-multiple-sites.html#cb35-183" tabindex="-1"></a>    }</span>
<span id="cb35-184"><a href="population-growth-on-multiple-sites.html#cb35-184" tabindex="-1"></a>    inactives <span class="ot">&lt;-</span> (Nts[i<span class="dv">-1</span>,]<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb35-185"><a href="population-growth-on-multiple-sites.html#cb35-185" tabindex="-1"></a>    <span class="cf">for</span> ( s <span class="cf">in</span> <span class="fu">sample</span>(<span class="fu">seq_along</span>(sites)[<span class="sc">!</span>inactives]) ){</span>
<span id="cb35-186"><a href="population-growth-on-multiple-sites.html#cb35-186" tabindex="-1"></a>      <span class="cf">if</span> ( visu ) {</span>
<span id="cb35-187"><a href="population-growth-on-multiple-sites.html#cb35-187" tabindex="-1"></a>        <span class="do">### visualisation =====</span></span>
<span id="cb35-188"><a href="population-growth-on-multiple-sites.html#cb35-188" tabindex="-1"></a>        frame <span class="ot">&lt;-</span> frame<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb35-189"><a href="population-growth-on-multiple-sites.html#cb35-189" tabindex="-1"></a>        filename <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;map_%08d.png&quot;</span>, frame)</span>
<span id="cb35-190"><a href="population-growth-on-multiple-sites.html#cb35-190" tabindex="-1"></a>        <span class="fu">png</span>(<span class="fu">file.path</span>(foldervid,filename), <span class="at">width=</span><span class="dv">800</span>, <span class="at">height=</span><span class="dv">800</span>, <span class="at">pointsize=</span><span class="dv">20</span>)</span>
<span id="cb35-191"><a href="population-growth-on-multiple-sites.html#cb35-191" tabindex="-1"></a>        <span class="fu">plotMap</span>(dem,water,<span class="fu">paste0</span>(<span class="st">&quot;year &quot;</span>, i))</span>
<span id="cb35-192"><a href="population-growth-on-multiple-sites.html#cb35-192" tabindex="-1"></a>        <span class="do">########</span></span>
<span id="cb35-193"><a href="population-growth-on-multiple-sites.html#cb35-193" tabindex="-1"></a>      }</span>
<span id="cb35-194"><a href="population-growth-on-multiple-sites.html#cb35-194" tabindex="-1"></a>      </span>
<span id="cb35-195"><a href="population-growth-on-multiple-sites.html#cb35-195" tabindex="-1"></a>      city <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb35-196"><a href="population-growth-on-multiple-sites.html#cb35-196" tabindex="-1"></a>      Ips[[s]] <span class="ot">&lt;-</span> <span class="fu">Gpd</span>( <span class="co">#compute new population for the sites</span></span>
<span id="cb35-197"><a href="population-growth-on-multiple-sites.html#cb35-197" tabindex="-1"></a>        Ips[[s]], <span class="at">K =</span> Ks[[s]],</span>
<span id="cb35-198"><a href="population-growth-on-multiple-sites.html#cb35-198" tabindex="-1"></a>        <span class="at">p_offspring =</span> prob_birth[sites<span class="sc">$</span>culture[s]],</span>
<span id="cb35-199"><a href="population-growth-on-multiple-sites.html#cb35-199" tabindex="-1"></a>        <span class="at">prob =</span> prob_survive[sites<span class="sc">$</span>culture[s]]</span>
<span id="cb35-200"><a href="population-growth-on-multiple-sites.html#cb35-200" tabindex="-1"></a>      )</span>
<span id="cb35-201"><a href="population-growth-on-multiple-sites.html#cb35-201" tabindex="-1"></a>      newN <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Ips[[s]]) <span class="co">#count population size</span></span>
<span id="cb35-202"><a href="population-growth-on-multiple-sites.html#cb35-202" tabindex="-1"></a>      </span>
<span id="cb35-203"><a href="population-growth-on-multiple-sites.html#cb35-203" tabindex="-1"></a>      <span class="cf">if</span>(newN <span class="sc">&gt;=</span> (Ks[[s]])){ <span class="co">#if new population is more than carrying capacity: migration scenario</span></span>
<span id="cb35-204"><a href="population-growth-on-multiple-sites.html#cb35-204" tabindex="-1"></a>        migrants <span class="ot">&lt;-</span> newN <span class="sc">-</span> <span class="fu">round</span>(Ks[[s]]<span class="sc">*</span><span class="fl">0.9</span>)</span>
<span id="cb35-205"><a href="population-growth-on-multiple-sites.html#cb35-205" tabindex="-1"></a>        <span class="do">##Creation of new city</span></span>
<span id="cb35-206"><a href="population-growth-on-multiple-sites.html#cb35-206" tabindex="-1"></a>        new_site <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb35-207"><a href="population-growth-on-multiple-sites.html#cb35-207" tabindex="-1"></a>        <span class="co">#if(sites$culture[s]==&quot;F&quot;)print(paste(&quot;possib&quot;,migrants, (minimals[sites$culture[s]]*sites$Ks[s])))</span></span>
<span id="cb35-208"><a href="population-growth-on-multiple-sites.html#cb35-208" tabindex="-1"></a>        tmp <span class="ot">&lt;-</span> Nts[i<span class="dv">-1</span>,]</span>
<span id="cb35-209"><a href="population-growth-on-multiple-sites.html#cb35-209" tabindex="-1"></a>        tmp[Nts[i,] <span class="sc">&gt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> Nts[i, Nts[i,] <span class="sc">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb35-210"><a href="population-growth-on-multiple-sites.html#cb35-210" tabindex="-1"></a>        <span class="co">#tmp=tmp+sqrt(sites$Ks)</span></span>
<span id="cb35-211"><a href="population-growth-on-multiple-sites.html#cb35-211" tabindex="-1"></a>        havemoved <span class="ot">&lt;-</span> F</span>
<span id="cb35-212"><a href="population-growth-on-multiple-sites.html#cb35-212" tabindex="-1"></a>        </span>
<span id="cb35-213"><a href="population-growth-on-multiple-sites.html#cb35-213" tabindex="-1"></a>        <span class="cf">if</span> (migrants <span class="sc">&gt;=</span> (minimals[sites<span class="sc">$</span>culture[s]]<span class="sc">*</span>sites<span class="sc">$</span>Ks[s]) <span class="sc">&amp;</span> <span class="fu">runif</span>(<span class="dv">1</span>)<span class="sc">&lt;</span>prob_split[sites<span class="sc">$</span>culture[s]] ){</span>
<span id="cb35-214"><a href="population-growth-on-multiple-sites.html#cb35-214" tabindex="-1"></a>          <span class="co">#if supopulation &gt; 10 people, 10% chance of creation of a new city</span></span>
<span id="cb35-215"><a href="population-growth-on-multiple-sites.html#cb35-215" tabindex="-1"></a>          </span>
<span id="cb35-216"><a href="population-growth-on-multiple-sites.html#cb35-216" tabindex="-1"></a>          <span class="co">#print(paste(&quot;look for new spot for &quot;,migrants, &quot;from site&quot;,s,&quot;culture&quot;,sites$culture[s]))</span></span>
<span id="cb35-217"><a href="population-growth-on-multiple-sites.html#cb35-217" tabindex="-1"></a>          <span class="co">#mean of area of influence</span></span>
<span id="cb35-218"><a href="population-growth-on-multiple-sites.html#cb35-218" tabindex="-1"></a>          infarea <span class="ot">&lt;-</span> (<span class="fu">sqrt</span>(tmp)<span class="sc">+</span>penal_cul[cultures]) <span class="sc">*</span> buffersettl</span>
<span id="cb35-219"><a href="population-growth-on-multiple-sites.html#cb35-219" tabindex="-1"></a>          buffersize <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(infarea), infarea, infarea <span class="sc">*</span> <span class="fl">0.1</span>)</span>
<span id="cb35-220"><a href="population-growth-on-multiple-sites.html#cb35-220" tabindex="-1"></a>          buffersize[tmp<span class="sc">==</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb35-221"><a href="population-growth-on-multiple-sites.html#cb35-221" tabindex="-1"></a>          territory <span class="ot">&lt;-</span> <span class="fu">erase</span>(viable, <span class="fu">buffer</span>(sites, buffersize))</span>
<span id="cb35-222"><a href="population-growth-on-multiple-sites.html#cb35-222" tabindex="-1"></a>          </span>
<span id="cb35-223"><a href="population-growth-on-multiple-sites.html#cb35-223" tabindex="-1"></a>          <span class="cf">if</span>( <span class="fu">length</span>(territory)<span class="sc">&gt;</span><span class="dv">0</span> ){</span>
<span id="cb35-224"><a href="population-growth-on-multiple-sites.html#cb35-224" tabindex="-1"></a>            <span class="co">#print(paste(&quot;found new spot&quot;,migrants))</span></span>
<span id="cb35-225"><a href="population-growth-on-multiple-sites.html#cb35-225" tabindex="-1"></a>            </span>
<span id="cb35-226"><a href="population-growth-on-multiple-sites.html#cb35-226" tabindex="-1"></a>            <span class="do">##select a new site given its distance to the old one and the ressourcesource available in ressources</span></span>
<span id="cb35-227"><a href="population-growth-on-multiple-sites.html#cb35-227" tabindex="-1"></a>            d2 <span class="ot">&lt;-</span> <span class="fu">logisticdecay</span>(</span>
<span id="cb35-228"><a href="population-growth-on-multiple-sites.html#cb35-228" tabindex="-1"></a>              sites[s], dem, <span class="at">x=</span><span class="dv">20000</span><span class="sc">*</span>cul_ext[sites<span class="sc">$</span>culture[s]]</span>
<span id="cb35-229"><a href="population-growth-on-multiple-sites.html#cb35-229" tabindex="-1"></a>            )</span>
<span id="cb35-230"><a href="population-growth-on-multiple-sites.html#cb35-230" tabindex="-1"></a>            w <span class="ot">&lt;-</span> (<span class="fl">0.7</span> <span class="sc">*</span> d2 <span class="sc">+</span> <span class="fl">0.3</span><span class="sc">*</span>ressources) <span class="sc">/</span> (<span class="fl">0.7</span><span class="sc">*</span><span class="fu">minmax</span>(d2)[<span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.3</span><span class="sc">*</span><span class="fu">minmax</span>(ressources)[<span class="dv">2</span>])</span>
<span id="cb35-231"><a href="population-growth-on-multiple-sites.html#cb35-231" tabindex="-1"></a>            new_site <span class="ot">&lt;-</span> <span class="fu">spatSample</span>(</span>
<span id="cb35-232"><a href="population-growth-on-multiple-sites.html#cb35-232" tabindex="-1"></a>              <span class="at">x=</span><span class="fu">mask</span>(</span>
<span id="cb35-233"><a href="population-growth-on-multiple-sites.html#cb35-233" tabindex="-1"></a>                w <span class="sc">*</span> <span class="fu">logisticdecay</span>(sites[s], dem, <span class="at">k=</span><span class="fl">0.00002</span>,</span>
<span id="cb35-234"><a href="population-growth-on-multiple-sites.html#cb35-234" tabindex="-1"></a>                                  <span class="at">x=</span><span class="dv">20000</span><span class="sc">*</span>cul_ext[sites<span class="sc">$</span>culture[s]]),</span>
<span id="cb35-235"><a href="population-growth-on-multiple-sites.html#cb35-235" tabindex="-1"></a>                territory),</span>
<span id="cb35-236"><a href="population-growth-on-multiple-sites.html#cb35-236" tabindex="-1"></a>              <span class="at">size=</span><span class="dv">1</span>, <span class="at">method=</span><span class="st">&quot;weights&quot;</span>, <span class="at">xy=</span>T)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb35-237"><a href="population-growth-on-multiple-sites.html#cb35-237" tabindex="-1"></a>            new_site <span class="ot">&lt;-</span> <span class="fu">vect</span>(new_site, <span class="at">geom=</span><span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>))</span>
<span id="cb35-238"><a href="population-growth-on-multiple-sites.html#cb35-238" tabindex="-1"></a>            </span>
<span id="cb35-239"><a href="population-growth-on-multiple-sites.html#cb35-239" tabindex="-1"></a>            <span class="cf">if</span> ( <span class="fu">length</span>(new_site)<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">crds</span>(new_site))) ){</span>
<span id="cb35-240"><a href="population-growth-on-multiple-sites.html#cb35-240" tabindex="-1"></a>              <span class="do">##add new site to site listes</span></span>
<span id="cb35-241"><a href="population-growth-on-multiple-sites.html#cb35-241" tabindex="-1"></a>              <span class="do">##initialise population struc of new site</span></span>
<span id="cb35-242"><a href="population-growth-on-multiple-sites.html#cb35-242" tabindex="-1"></a>              <span class="co">#print(paste(&quot;total sites:&quot;,length(Ips)))</span></span>
<span id="cb35-243"><a href="population-growth-on-multiple-sites.html#cb35-243" tabindex="-1"></a>              <span class="co">#print(paste(&quot;dim Nts:&quot;,dim(Nts)[2]))</span></span>
<span id="cb35-244"><a href="population-growth-on-multiple-sites.html#cb35-244" tabindex="-1"></a>              <span class="co">#print(paste(&quot;site sf Nts:&quot;,length(sites)))</span></span>
<span id="cb35-245"><a href="population-growth-on-multiple-sites.html#cb35-245" tabindex="-1"></a>              </span>
<span id="cb35-246"><a href="population-growth-on-multiple-sites.html#cb35-246" tabindex="-1"></a>              Ips[[<span class="fu">length</span>(Ips)<span class="sc">+</span><span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">initpopstruc</span>(<span class="at">n=</span>migrants) <span class="co">#initialise a fake populaition, will be updated by real migrants later</span></span>
<span id="cb35-247"><a href="population-growth-on-multiple-sites.html#cb35-247" tabindex="-1"></a>              new_site<span class="sc">$</span>culture <span class="ot">&lt;-</span> sites<span class="sc">$</span>culture[s]</span>
<span id="cb35-248"><a href="population-growth-on-multiple-sites.html#cb35-248" tabindex="-1"></a>              new_site<span class="sc">$</span>Ks <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">initKs</span>(</span>
<span id="cb35-249"><a href="population-growth-on-multiple-sites.html#cb35-249" tabindex="-1"></a>                Kbase, <span class="at">sites=</span>new_site, ressources,</span>
<span id="cb35-250"><a href="population-growth-on-multiple-sites.html#cb35-250" tabindex="-1"></a>                <span class="at">sizeex=</span><span class="st">&quot;F&quot;</span>, <span class="at">rate=</span><span class="fl">0.45</span>))</span>
<span id="cb35-251"><a href="population-growth-on-multiple-sites.html#cb35-251" tabindex="-1"></a>              <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;new settlement (&quot;</span>, sites<span class="sc">$</span>culture[s], <span class="st">&quot;) of K &quot;</span>,</span>
<span id="cb35-252"><a href="population-growth-on-multiple-sites.html#cb35-252" tabindex="-1"></a>                           new_site<span class="sc">$</span>Ks, <span class="st">&quot; and pop &quot;</span>, migrants))</span>
<span id="cb35-253"><a href="population-growth-on-multiple-sites.html#cb35-253" tabindex="-1"></a>              </span>
<span id="cb35-254"><a href="population-growth-on-multiple-sites.html#cb35-254" tabindex="-1"></a>              sites <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sites, new_site)</span>
<span id="cb35-255"><a href="population-growth-on-multiple-sites.html#cb35-255" tabindex="-1"></a>              </span>
<span id="cb35-256"><a href="population-growth-on-multiple-sites.html#cb35-256" tabindex="-1"></a>              Ks[<span class="fu">length</span>(Ks)<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> new_site<span class="sc">$</span>Ks</span>
<span id="cb35-257"><a href="population-growth-on-multiple-sites.html#cb35-257" tabindex="-1"></a>              city <span class="ot">&lt;-</span> <span class="fu">length</span>(Ips)</span>
<span id="cb35-258"><a href="population-growth-on-multiple-sites.html#cb35-258" tabindex="-1"></a>              Nts <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Nts, <span class="fu">rep</span>(<span class="dv">0</span>,ts<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb35-259"><a href="population-growth-on-multiple-sites.html#cb35-259" tabindex="-1"></a>              Nts[i, city] <span class="ot">&lt;-</span> migrants</span>
<span id="cb35-260"><a href="population-growth-on-multiple-sites.html#cb35-260" tabindex="-1"></a>              cultures <span class="ot">&lt;-</span> <span class="fu">c</span>(cultures, cultures[s])</span>
<span id="cb35-261"><a href="population-growth-on-multiple-sites.html#cb35-261" tabindex="-1"></a>              <span class="co">#print(paste(&quot;new site sf Nts:&quot;,length(sites)))</span></span>
<span id="cb35-262"><a href="population-growth-on-multiple-sites.html#cb35-262" tabindex="-1"></a>              <span class="co">#print(paste(&quot;new dim Nts:&quot;,dim(Nts)[2]))</span></span>
<span id="cb35-263"><a href="population-growth-on-multiple-sites.html#cb35-263" tabindex="-1"></a>              <span class="co">#print(paste(&quot;new total sites:&quot;,length(Ips)))</span></span>
<span id="cb35-264"><a href="population-growth-on-multiple-sites.html#cb35-264" tabindex="-1"></a>              havemoved <span class="ot">&lt;-</span> T</span>
<span id="cb35-265"><a href="population-growth-on-multiple-sites.html#cb35-265" tabindex="-1"></a>            }</span>
<span id="cb35-266"><a href="population-growth-on-multiple-sites.html#cb35-266" tabindex="-1"></a>          }</span>
<span id="cb35-267"><a href="population-growth-on-multiple-sites.html#cb35-267" tabindex="-1"></a>        }</span>
<span id="cb35-268"><a href="population-growth-on-multiple-sites.html#cb35-268" tabindex="-1"></a>        <span class="do">## if no creation of new city happen, there is a certain probability that people will move</span></span>
<span id="cb35-269"><a href="population-growth-on-multiple-sites.html#cb35-269" tabindex="-1"></a>        <span class="cf">if</span>( <span class="fu">length</span>(new_site)<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> prob_move[sites<span class="sc">$</span>culture[s]] ){</span>
<span id="cb35-270"><a href="population-growth-on-multiple-sites.html#cb35-270" tabindex="-1"></a>          </span>
<span id="cb35-271"><a href="population-growth-on-multiple-sites.html#cb35-271" tabindex="-1"></a>          <span class="co">#getj</span></span>
<span id="cb35-272"><a href="population-growth-on-multiple-sites.html#cb35-272" tabindex="-1"></a>          att <span class="ot">&lt;-</span> <span class="fu">extract</span>(ressources,sites)[,<span class="dv">2</span>]</span>
<span id="cb35-273"><a href="population-growth-on-multiple-sites.html#cb35-273" tabindex="-1"></a>          space <span class="ot">&lt;-</span> sites<span class="sc">$</span>Ks <span class="sc">-</span> (Nts[i<span class="dv">-1</span>,] <span class="sc">+</span> migrants)</span>
<span id="cb35-274"><a href="population-growth-on-multiple-sites.html#cb35-274" tabindex="-1"></a>          dis <span class="ot">&lt;-</span> <span class="fu">extract</span>(<span class="fu">logisticdecay</span>(sites[s], dem, <span class="at">k=</span><span class="fl">0.00002</span>, <span class="at">x=</span><span class="dv">1</span>), sites)[,<span class="dv">2</span>]</span>
<span id="cb35-275"><a href="population-growth-on-multiple-sites.html#cb35-275" tabindex="-1"></a>          attractivity <span class="ot">&lt;-</span> att <span class="sc">*</span> space <span class="sc">*</span> dis</span>
<span id="cb35-276"><a href="population-growth-on-multiple-sites.html#cb35-276" tabindex="-1"></a>          <span class="co">#attractivity=attractivity*(1+10*(sites$culture[s]==sites$culture)) #4 times more likely to go to similar culture</span></span>
<span id="cb35-277"><a href="population-growth-on-multiple-sites.html#cb35-277" tabindex="-1"></a>          attractivity[s] <span class="ot">&lt;-</span> <span class="fu">min</span>(attractivity)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb35-278"><a href="population-growth-on-multiple-sites.html#cb35-278" tabindex="-1"></a>          attractivity <span class="ot">&lt;-</span> <span class="fu">exp</span>(attractivity)<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">exp</span>(attractivity))</span>
<span id="cb35-279"><a href="population-growth-on-multiple-sites.html#cb35-279" tabindex="-1"></a>          attractivity[Nts[i<span class="dv">-1</span>,]<span class="sc">&lt;</span><span class="dv">10</span>] <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb35-280"><a href="population-growth-on-multiple-sites.html#cb35-280" tabindex="-1"></a>          attractivity[sites<span class="sc">$</span>culture<span class="sc">!=</span>sites<span class="sc">$</span>culture[s]] <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb35-281"><a href="population-growth-on-multiple-sites.html#cb35-281" tabindex="-1"></a>          <span class="cf">if</span>(<span class="fu">any</span>(<span class="fu">is.na</span>(attractivity))){</span>
<span id="cb35-282"><a href="population-growth-on-multiple-sites.html#cb35-282" tabindex="-1"></a>            <span class="fu">print</span>(attractivity)</span>
<span id="cb35-283"><a href="population-growth-on-multiple-sites.html#cb35-283" tabindex="-1"></a>            attractivity[<span class="fu">is.na</span>(attractivity)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb35-284"><a href="population-growth-on-multiple-sites.html#cb35-284" tabindex="-1"></a>          }</span>
<span id="cb35-285"><a href="population-growth-on-multiple-sites.html#cb35-285" tabindex="-1"></a>          </span>
<span id="cb35-286"><a href="population-growth-on-multiple-sites.html#cb35-286" tabindex="-1"></a>          city <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">size=</span><span class="dv">1</span>, <span class="at">x=</span><span class="fu">seq_along</span>(sites), <span class="at">prob=</span>attractivity)</span>
<span id="cb35-287"><a href="population-growth-on-multiple-sites.html#cb35-287" tabindex="-1"></a>          Nts[i,city] <span class="ot">&lt;-</span> Nts[i<span class="dv">-1</span>,city] <span class="sc">+</span> migrants</span>
<span id="cb35-288"><a href="population-growth-on-multiple-sites.html#cb35-288" tabindex="-1"></a>          <span class="fu">print</span>(<span class="fu">paste</span>(migrants, <span class="st">&quot;migrant from&quot;</span>, sites<span class="sc">$</span>culture[s],</span>
<span id="cb35-289"><a href="population-growth-on-multiple-sites.html#cb35-289" tabindex="-1"></a>                      <span class="st">&quot;to&quot;</span>, sites<span class="sc">$</span>culture[city]))</span>
<span id="cb35-290"><a href="population-growth-on-multiple-sites.html#cb35-290" tabindex="-1"></a>          havemoved <span class="ot">&lt;-</span> T</span>
<span id="cb35-291"><a href="population-growth-on-multiple-sites.html#cb35-291" tabindex="-1"></a>        }</span>
<span id="cb35-292"><a href="population-growth-on-multiple-sites.html#cb35-292" tabindex="-1"></a>        <span class="cf">if</span>( havemoved ){</span>
<span id="cb35-293"><a href="population-growth-on-multiple-sites.html#cb35-293" tabindex="-1"></a>          </span>
<span id="cb35-294"><a href="population-growth-on-multiple-sites.html#cb35-294" tabindex="-1"></a>          <span class="co">#print(paste(&quot;old spot&quot;,migrants,&quot; for &quot;,nrow(Ips[[s]])))</span></span>
<span id="cb35-295"><a href="population-growth-on-multiple-sites.html#cb35-295" tabindex="-1"></a>          <span class="co">#print(paste(&quot;old new spot&quot;,migrants,&quot; for &quot;,nrow(Ips[[city]])))</span></span>
<span id="cb35-296"><a href="population-growth-on-multiple-sites.html#cb35-296" tabindex="-1"></a>          </span>
<span id="cb35-297"><a href="population-growth-on-multiple-sites.html#cb35-297" tabindex="-1"></a>          <span class="co">#if(city&gt;length(Ips))print(paste(&quot;problem, migrants:&quot;,migrants))</span></span>
<span id="cb35-298"><a href="population-growth-on-multiple-sites.html#cb35-298" tabindex="-1"></a>          <span class="co">#print(paste(&quot;the other:&quot;,city))</span></span>
<span id="cb35-299"><a href="population-growth-on-multiple-sites.html#cb35-299" tabindex="-1"></a>          Ips[<span class="fu">c</span>(s,city)] <span class="ot">&lt;-</span> <span class="fu">changePopSize</span>(</span>
<span id="cb35-300"><a href="population-growth-on-multiple-sites.html#cb35-300" tabindex="-1"></a>            <span class="at">loosingPop=</span>Ips[[s]], <span class="at">winingPop=</span>Ips[[city]], <span class="at">size=</span>migrants</span>
<span id="cb35-301"><a href="population-growth-on-multiple-sites.html#cb35-301" tabindex="-1"></a>          )</span>
<span id="cb35-302"><a href="population-growth-on-multiple-sites.html#cb35-302" tabindex="-1"></a>          newN <span class="ot">&lt;-</span> newN <span class="sc">-</span> migrants</span>
<span id="cb35-303"><a href="population-growth-on-multiple-sites.html#cb35-303" tabindex="-1"></a>          <span class="co">#print(paste(&quot;loosing &quot;,newN,&quot; vs &quot;,nrow(Ips[[s]])))</span></span>
<span id="cb35-304"><a href="population-growth-on-multiple-sites.html#cb35-304" tabindex="-1"></a>          <span class="co">#print(paste(&quot;wining &quot;,newN,&quot; vs &quot;,nrow(Ips[[city]])))</span></span>
<span id="cb35-305"><a href="population-growth-on-multiple-sites.html#cb35-305" tabindex="-1"></a>        }</span>
<span id="cb35-306"><a href="population-growth-on-multiple-sites.html#cb35-306" tabindex="-1"></a>        </span>
<span id="cb35-307"><a href="population-growth-on-multiple-sites.html#cb35-307" tabindex="-1"></a>      }</span>
<span id="cb35-308"><a href="population-growth-on-multiple-sites.html#cb35-308" tabindex="-1"></a>      Nts[i,s] <span class="ot">&lt;-</span> newN</span>
<span id="cb35-309"><a href="population-growth-on-multiple-sites.html#cb35-309" tabindex="-1"></a>      </span>
<span id="cb35-310"><a href="population-growth-on-multiple-sites.html#cb35-310" tabindex="-1"></a>      <span class="cf">if</span> (visu){</span>
<span id="cb35-311"><a href="population-growth-on-multiple-sites.html#cb35-311" tabindex="-1"></a>        <span class="do">###visualisation=========</span></span>
<span id="cb35-312"><a href="population-growth-on-multiple-sites.html#cb35-312" tabindex="-1"></a>        sitescols <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">length</span>(sites))</span>
<span id="cb35-313"><a href="population-growth-on-multiple-sites.html#cb35-313" tabindex="-1"></a>        siteslwd <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">length</span>(sites))</span>
<span id="cb35-314"><a href="population-growth-on-multiple-sites.html#cb35-314" tabindex="-1"></a>        ii<span class="ot">=</span><span class="cn">NULL</span></span>
<span id="cb35-315"><a href="population-growth-on-multiple-sites.html#cb35-315" tabindex="-1"></a>        <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(city)){</span>
<span id="cb35-316"><a href="population-growth-on-multiple-sites.html#cb35-316" tabindex="-1"></a>          sitescols[s] <span class="ot">&lt;-</span> <span class="st">&quot;yellow&quot;</span></span>
<span id="cb35-317"><a href="population-growth-on-multiple-sites.html#cb35-317" tabindex="-1"></a>          sitescols[city] <span class="ot">&lt;-</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb35-318"><a href="population-growth-on-multiple-sites.html#cb35-318" tabindex="-1"></a>          siteslwd[s] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb35-319"><a href="population-growth-on-multiple-sites.html#cb35-319" tabindex="-1"></a>          siteslwd[city] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb35-320"><a href="population-growth-on-multiple-sites.html#cb35-320" tabindex="-1"></a>          ii <span class="ot">&lt;-</span> <span class="fu">st_cast</span>(<span class="fu">st_combine</span>(<span class="fu">st_as_sf</span>(sites[<span class="fu">c</span>(s, city)])), <span class="st">&quot;LINESTRING&quot;</span>)</span>
<span id="cb35-321"><a href="population-growth-on-multiple-sites.html#cb35-321" tabindex="-1"></a>        }</span>
<span id="cb35-322"><a href="population-growth-on-multiple-sites.html#cb35-322" tabindex="-1"></a>        <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(ii)){</span>
<span id="cb35-323"><a href="population-growth-on-multiple-sites.html#cb35-323" tabindex="-1"></a>          <span class="fu">plot</span>(ii ,<span class="at">add=</span>T)</span>
<span id="cb35-324"><a href="population-growth-on-multiple-sites.html#cb35-324" tabindex="-1"></a>        }</span>
<span id="cb35-325"><a href="population-growth-on-multiple-sites.html#cb35-325" tabindex="-1"></a>        tmp <span class="ot">&lt;-</span> Nts[i<span class="dv">-1</span>,]</span>
<span id="cb35-326"><a href="population-growth-on-multiple-sites.html#cb35-326" tabindex="-1"></a>        tmp[Nts[i,]<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> Nts[i,Nts[i,]<span class="sc">&gt;</span><span class="dv">0</span>]</span>
<span id="cb35-327"><a href="population-growth-on-multiple-sites.html#cb35-327" tabindex="-1"></a>        <span class="fu">plot</span>(sites, <span class="at">cex=</span>(<span class="fu">as.integer</span>(Nts[i,]<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">*</span> <span class="fl">0.3</span> <span class="sc">+</span> Nts[i,]<span class="sc">/</span><span class="dv">200</span>), </span>
<span id="cb35-328"><a href="population-growth-on-multiple-sites.html#cb35-328" tabindex="-1"></a>             <span class="at">pch=</span><span class="dv">21</span>, <span class="at">add=</span>T, <span class="at">bg=</span><span class="fu">rainbow</span>(<span class="dv">2</span>, <span class="at">alpha=</span><span class="fl">0.6</span>)[<span class="fu">as.factor</span>(sites<span class="sc">$</span>culture)],</span>
<span id="cb35-329"><a href="population-growth-on-multiple-sites.html#cb35-329" tabindex="-1"></a>             <span class="at">lwd=</span>siteslwd, <span class="at">col=</span>sitescols)</span>
<span id="cb35-330"><a href="population-growth-on-multiple-sites.html#cb35-330" tabindex="-1"></a>        <span class="fu">dev.off</span>()</span>
<span id="cb35-331"><a href="population-growth-on-multiple-sites.html#cb35-331" tabindex="-1"></a>        <span class="do">###=======================</span></span>
<span id="cb35-332"><a href="population-growth-on-multiple-sites.html#cb35-332" tabindex="-1"></a>      }</span>
<span id="cb35-333"><a href="population-growth-on-multiple-sites.html#cb35-333" tabindex="-1"></a>    }</span>
<span id="cb35-334"><a href="population-growth-on-multiple-sites.html#cb35-334" tabindex="-1"></a>    <span class="cf">if</span>(visumin){</span>
<span id="cb35-335"><a href="population-growth-on-multiple-sites.html#cb35-335" tabindex="-1"></a>      <span class="fu">plot</span>(sites, <span class="at">cex=</span>(<span class="fu">as.integer</span>(Nts[i,]<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">*</span> <span class="fl">0.3</span> <span class="sc">+</span> Nts[i,]<span class="sc">/</span><span class="dv">200</span>),</span>
<span id="cb35-336"><a href="population-growth-on-multiple-sites.html#cb35-336" tabindex="-1"></a>           <span class="at">pch=</span><span class="dv">21</span>, <span class="at">add=</span>T, <span class="at">bg=</span><span class="fu">rainbow</span>(<span class="dv">2</span>, <span class="at">alpha=</span><span class="fl">0.6</span>)[<span class="fu">as.factor</span>(sites<span class="sc">$</span>culture)])</span>
<span id="cb35-337"><a href="population-growth-on-multiple-sites.html#cb35-337" tabindex="-1"></a>    }</span>
<span id="cb35-338"><a href="population-growth-on-multiple-sites.html#cb35-338" tabindex="-1"></a>    potentialfighters <span class="ot">&lt;-</span> <span class="fu">which</span>(sites<span class="sc">$</span>culture<span class="sc">==</span><span class="st">&quot;F&quot;</span> <span class="sc">&amp;</span> Nts[i,]<span class="sc">&gt;</span><span class="dv">50</span>)</span>
<span id="cb35-339"><a href="population-growth-on-multiple-sites.html#cb35-339" tabindex="-1"></a>    <span class="cf">for</span> (s <span class="cf">in</span> <span class="fu">sample</span>(<span class="at">x=</span>potentialfighters, <span class="at">size=</span><span class="fu">round</span>(<span class="fu">length</span>(potentialfighters)<span class="sc">*</span><span class="fl">0.1</span>))){</span>
<span id="cb35-340"><a href="population-growth-on-multiple-sites.html#cb35-340" tabindex="-1"></a>      buff <span class="ot">&lt;-</span> bufferatack</span>
<span id="cb35-341"><a href="population-growth-on-multiple-sites.html#cb35-341" tabindex="-1"></a>      potentialvictims <span class="ot">&lt;-</span> <span class="fu">which</span>(sites<span class="sc">$</span>culture <span class="sc">!=</span>sites<span class="sc">$</span>culture[s] <span class="sc">&amp;</span> Nts[i,]<span class="sc">&gt;</span><span class="dv">0</span>) </span>
<span id="cb35-342"><a href="population-growth-on-multiple-sites.html#cb35-342" tabindex="-1"></a>      clash <span class="ot">&lt;-</span> <span class="fu">whotouch</span>(s, sites, <span class="at">Ne=</span>Nts[i,], <span class="at">buffersize=</span>buff)</span>
<span id="cb35-343"><a href="population-growth-on-multiple-sites.html#cb35-343" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">length</span>(clash)<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(clash)){</span>
<span id="cb35-344"><a href="population-growth-on-multiple-sites.html#cb35-344" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">length</span>(clash) <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb35-345"><a href="population-growth-on-multiple-sites.html#cb35-345" tabindex="-1"></a>          attack <span class="ot">&lt;-</span> clash</span>
<span id="cb35-346"><a href="population-growth-on-multiple-sites.html#cb35-346" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb35-347"><a href="population-growth-on-multiple-sites.html#cb35-347" tabindex="-1"></a>          attack <span class="ot">&lt;-</span> <span class="fu">sample</span>(clash, <span class="dv">1</span>)</span>
<span id="cb35-348"><a href="population-growth-on-multiple-sites.html#cb35-348" tabindex="-1"></a>        }</span>
<span id="cb35-349"><a href="population-growth-on-multiple-sites.html#cb35-349" tabindex="-1"></a>        newns <span class="ot">&lt;-</span> <span class="fu">fightbetterloss</span>(<span class="at">Ne=</span>Nts[i,], <span class="at">a=</span>s, <span class="at">b=</span>attack)</span>
<span id="cb35-350"><a href="population-growth-on-multiple-sites.html#cb35-350" tabindex="-1"></a>        casualties <span class="ot">&lt;-</span> <span class="fu">sum</span>(Nts[i, <span class="fu">c</span>(s,attack)] <span class="sc">-</span> newns[<span class="fu">c</span>(s,attack)])</span>
<span id="cb35-351"><a href="population-growth-on-multiple-sites.html#cb35-351" tabindex="-1"></a>        warcasualties[i] <span class="ot">&lt;-</span> casualties</span>
<span id="cb35-352"><a href="population-growth-on-multiple-sites.html#cb35-352" tabindex="-1"></a>        sizew <span class="ot">&lt;-</span> casualties<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">4000</span></span>
<span id="cb35-353"><a href="population-growth-on-multiple-sites.html#cb35-353" tabindex="-1"></a>        <span class="fu">warpoints</span>(sites, s, attack, <span class="at">Ne=</span>Nts[i,],</span>
<span id="cb35-354"><a href="population-growth-on-multiple-sites.html#cb35-354" tabindex="-1"></a>                  <span class="at">buffersize=</span>buff, <span class="at">sizewar=</span>sizew<span class="fl">+0.5</span>)</span>
<span id="cb35-355"><a href="population-growth-on-multiple-sites.html#cb35-355" tabindex="-1"></a>        </span>
<span id="cb35-356"><a href="population-growth-on-multiple-sites.html#cb35-356" tabindex="-1"></a>        <span class="co">#effectively kill people in population (should be done taking into account age pyramid to be more realistic)</span></span>
<span id="cb35-357"><a href="population-growth-on-multiple-sites.html#cb35-357" tabindex="-1"></a>        Ips[[s]] <span class="ot">&lt;-</span> <span class="fu">changePopSize</span>(<span class="at">loosingPop=</span>Ips[[s]],</span>
<span id="cb35-358"><a href="population-growth-on-multiple-sites.html#cb35-358" tabindex="-1"></a>                                  <span class="at">size=</span>(Nts[i,s] <span class="sc">-</span> newns[s]))</span>
<span id="cb35-359"><a href="population-growth-on-multiple-sites.html#cb35-359" tabindex="-1"></a>        Ips[[attack]] <span class="ot">&lt;-</span> <span class="fu">changePopSize</span>(<span class="at">loosingPop=</span>Ips[[attack]],</span>
<span id="cb35-360"><a href="population-growth-on-multiple-sites.html#cb35-360" tabindex="-1"></a>                                       <span class="at">size=</span>(Nts[i, attack] <span class="sc">-</span> newns[attack]))</span>
<span id="cb35-361"><a href="population-growth-on-multiple-sites.html#cb35-361" tabindex="-1"></a>        Nts[i,] <span class="ot">&lt;-</span> newns</span>
<span id="cb35-362"><a href="population-growth-on-multiple-sites.html#cb35-362" tabindex="-1"></a>        <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;fight : #&quot;</span>, s, <span class="st">&quot; (&quot;</span>,</span>
<span id="cb35-363"><a href="population-growth-on-multiple-sites.html#cb35-363" tabindex="-1"></a>                     cultures[s], <span class="st">&quot;) left with &quot;</span>, Nts[i,s],</span>
<span id="cb35-364"><a href="population-growth-on-multiple-sites.html#cb35-364" tabindex="-1"></a>                     <span class="st">&quot; (bef:&quot;</span>, Nts[i<span class="dv">-1</span>,s], <span class="st">&quot;) ind., attacked: #&quot;</span>, attack, <span class="st">&quot; (&quot;</span>,</span>
<span id="cb35-365"><a href="population-growth-on-multiple-sites.html#cb35-365" tabindex="-1"></a>                     cultures[attack], <span class="st">&quot;) left with &quot;</span>, Nts[i,attack],</span>
<span id="cb35-366"><a href="population-growth-on-multiple-sites.html#cb35-366" tabindex="-1"></a>                     <span class="st">&quot; (bef:&quot;</span>, Nts[i<span class="dv">-1</span>,attack],<span class="st">&quot;) ind., #death=&quot;</span>,casualties))</span>
<span id="cb35-367"><a href="population-growth-on-multiple-sites.html#cb35-367" tabindex="-1"></a>      }</span>
<span id="cb35-368"><a href="population-growth-on-multiple-sites.html#cb35-368" tabindex="-1"></a>    }</span>
<span id="cb35-369"><a href="population-growth-on-multiple-sites.html#cb35-369" tabindex="-1"></a>    <span class="cf">if</span>(visumin){</span>
<span id="cb35-370"><a href="population-growth-on-multiple-sites.html#cb35-370" tabindex="-1"></a>      <span class="fu">dev.off</span>()</span>
<span id="cb35-371"><a href="population-growth-on-multiple-sites.html#cb35-371" tabindex="-1"></a>    }</span>
<span id="cb35-372"><a href="population-growth-on-multiple-sites.html#cb35-372" tabindex="-1"></a>  }</span>
<span id="cb35-373"><a href="population-growth-on-multiple-sites.html#cb35-373" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">Nts=</span>Nts, <span class="at">warcasualties=</span>warcasualties, <span class="at">Ips=</span>Ips, <span class="at">sites=</span>sites))</span>
<span id="cb35-374"><a href="population-growth-on-multiple-sites.html#cb35-374" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>The list <code>onesimu</code> contains a few interesting info:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="population-growth-on-multiple-sites.html#cb36-1" tabindex="-1"></a>Nts <span class="ot">&lt;-</span> onesimu<span class="sc">$</span>Nts <span class="co"># population at each timestep</span></span>
<span id="cb36-2"><a href="population-growth-on-multiple-sites.html#cb36-2" tabindex="-1"></a>warcasualties <span class="ot">&lt;-</span> onesimu<span class="sc">$</span>warcasualties <span class="co">#death by war at each time step</span></span></code></pre></div>
<p>Use ressource to adjust the Ks:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="population-growth-on-multiple-sites.html#cb37-1" tabindex="-1"></a><span class="fu">plot</span>(sites, <span class="at">cex=</span>(<span class="dv">1</span><span class="sc">+</span>Nts[<span class="dv">1</span>,]<span class="sc">/</span><span class="dv">100</span>), <span class="at">pch=</span><span class="dv">21</span>, <span class="at">bg=</span><span class="fu">rainbow</span>(<span class="dv">2</span>, <span class="at">alpha=</span><span class="fl">0.6</span>)[<span class="fu">as.factor</span>(sites<span class="sc">$</span>culture)])</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>We look at the simulation step by stepk
Step by step to allow interaction between sites:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="population-growth-on-multiple-sites.html#cb38-1" tabindex="-1"></a><span class="do">## visualise trajectories for each site</span></span>
<span id="cb38-2"><a href="population-growth-on-multiple-sites.html#cb38-2" tabindex="-1"></a></span>
<span id="cb38-3"><a href="population-growth-on-multiple-sites.html#cb38-3" tabindex="-1"></a>i <span class="ot">&lt;-</span> ts</span>
<span id="cb38-4"><a href="population-growth-on-multiple-sites.html#cb38-4" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="at">type=</span><span class="st">&quot;n&quot;</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,i), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(Nts)), <span class="at">xlab=</span><span class="st">&quot;time&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;popsize&quot;</span>)</span>
<span id="cb38-5"><a href="population-growth-on-multiple-sites.html#cb38-5" tabindex="-1"></a><span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(Nts),</span>
<span id="cb38-6"><a href="population-growth-on-multiple-sites.html#cb38-6" tabindex="-1"></a>       <span class="cf">function</span>(j)<span class="fu">lines</span>(Nts[,j],<span class="at">col=</span><span class="fu">rainbow</span>(<span class="dv">2</span>)[<span class="fu">as.factor</span>(sites<span class="sc">$</span>culture)[j]])</span>
<span id="cb38-7"><a href="population-growth-on-multiple-sites.html#cb38-7" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="_main_files/figure-html/trajpersite-1.png" width="672" /></p>
<pre><code>## [[1]]
## NULL
## 
## [[2]]
## NULL
## 
## [[3]]
## NULL
## 
## [[4]]
## NULL
## 
## [[5]]
## NULL
## 
## [[6]]
## NULL
## 
## [[7]]
## NULL
## 
## [[8]]
## NULL
## 
## [[9]]
## NULL
## 
## [[10]]
## NULL
## 
## [[11]]
## NULL
## 
## [[12]]
## NULL
## 
## [[13]]
## NULL
## 
## [[14]]
## NULL
## 
## [[15]]
## NULL
## 
## [[16]]
## NULL
## 
## [[17]]
## NULL
## 
## [[18]]
## NULL
## 
## [[19]]
## NULL
## 
## [[20]]
## NULL
## 
## [[21]]
## NULL
## 
## [[22]]
## NULL
## 
## [[23]]
## NULL
## 
## [[24]]
## NULL
## 
## [[25]]
## NULL
## 
## [[26]]
## NULL
## 
## [[27]]
## NULL
## 
## [[28]]
## NULL
## 
## [[29]]
## NULL
## 
## [[30]]
## NULL
## 
## [[31]]
## NULL
## 
## [[32]]
## NULL
## 
## [[33]]
## NULL
## 
## [[34]]
## NULL
## 
## [[35]]
## NULL
## 
## [[36]]
## NULL
## 
## [[37]]
## NULL
## 
## [[38]]
## NULL
## 
## [[39]]
## NULL
## 
## [[40]]
## NULL
## 
## [[41]]
## NULL
## 
## [[42]]
## NULL
## 
## [[43]]
## NULL
## 
## [[44]]
## NULL
## 
## [[45]]
## NULL
## 
## [[46]]
## NULL
## 
## [[47]]
## NULL
## 
## [[48]]
## NULL
## 
## [[49]]
## NULL
## 
## [[50]]
## NULL
## 
## [[51]]
## NULL</code></pre>
<p>Visualise, Record deposit and loss. for the 5 first sites (see next chapters for <code>A_rates</code>).</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="population-growth-on-multiple-sites.html#cb40-1" tabindex="-1"></a>alldeposit <span class="ot">&lt;-</span> <span class="fu">lapply</span>(</span>
<span id="cb40-2"><a href="population-growth-on-multiple-sites.html#cb40-2" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb40-3"><a href="population-growth-on-multiple-sites.html#cb40-3" tabindex="-1"></a>  <span class="cf">function</span>(i){</span>
<span id="cb40-4"><a href="population-growth-on-multiple-sites.html#cb40-4" tabindex="-1"></a>    <span class="fu">Rec_c</span>(<span class="fu">sapply</span>(Nts[,i], A_rates), <span class="at">InitBP =</span> <span class="dv">15000</span>, <span class="at">ts=</span>ts, <span class="at">r=</span><span class="fl">0.2</span>, <span class="at">max_bone_thickness=</span><span class="st">&quot;m&quot;</span>)</span>
<span id="cb40-5"><a href="population-growth-on-multiple-sites.html#cb40-5" tabindex="-1"></a>  }</span>
<span id="cb40-6"><a href="population-growth-on-multiple-sites.html#cb40-6" tabindex="-1"></a>)</span>
<span id="cb40-7"><a href="population-growth-on-multiple-sites.html#cb40-7" tabindex="-1"></a>maxy <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">sapply</span>(alldeposit, <span class="cf">function</span>(i)<span class="fu">max</span>(<span class="fu">apply</span>(i,<span class="dv">2</span>,sum))))</span>
<span id="cb40-8"><a href="population-growth-on-multiple-sites.html#cb40-8" tabindex="-1"></a></span>
<span id="cb40-9"><a href="population-growth-on-multiple-sites.html#cb40-9" tabindex="-1"></a>nill <span class="ot">&lt;-</span> <span class="fu">lapply</span>(alldeposit, <span class="cf">function</span>(depo)<span class="fu">barplot</span>(<span class="fu">t</span>(depo), <span class="at">col=</span><span class="fu">viridis</span>(ts<span class="sc">+</span><span class="dv">1</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,maxy)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-27-1.png" width="25%" /><img src="_main_files/figure-html/unnamed-chunk-27-2.png" width="25%" /><img src="_main_files/figure-html/unnamed-chunk-27-3.png" width="25%" /><img src="_main_files/figure-html/unnamed-chunk-27-4.png" width="25%" /><img src="_main_files/figure-html/unnamed-chunk-27-5.png" width="25%" /></p>
<p>Population by time and culture</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="population-growth-on-multiple-sites.html#cb41-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="at">type=</span><span class="st">&quot;n&quot;</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,i), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(Nts)),</span>
<span id="cb41-2"><a href="population-growth-on-multiple-sites.html#cb41-2" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;time&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;popsize&quot;</span>)</span>
<span id="cb41-3"><a href="population-growth-on-multiple-sites.html#cb41-3" tabindex="-1"></a><span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(Nts),</span>
<span id="cb41-4"><a href="population-growth-on-multiple-sites.html#cb41-4" tabindex="-1"></a>       <span class="cf">function</span>(i)<span class="fu">lines</span>(Nts[,i], <span class="at">col=</span><span class="fu">rainbow</span>(<span class="dv">2</span>)[<span class="fu">as.factor</span>(sites<span class="sc">$</span>culture)[i]]))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<pre><code>## [[1]]
## NULL
## 
## [[2]]
## NULL
## 
## [[3]]
## NULL
## 
## [[4]]
## NULL
## 
## [[5]]
## NULL
## 
## [[6]]
## NULL
## 
## [[7]]
## NULL
## 
## [[8]]
## NULL
## 
## [[9]]
## NULL
## 
## [[10]]
## NULL
## 
## [[11]]
## NULL
## 
## [[12]]
## NULL
## 
## [[13]]
## NULL
## 
## [[14]]
## NULL
## 
## [[15]]
## NULL
## 
## [[16]]
## NULL
## 
## [[17]]
## NULL
## 
## [[18]]
## NULL
## 
## [[19]]
## NULL
## 
## [[20]]
## NULL
## 
## [[21]]
## NULL
## 
## [[22]]
## NULL
## 
## [[23]]
## NULL
## 
## [[24]]
## NULL
## 
## [[25]]
## NULL
## 
## [[26]]
## NULL
## 
## [[27]]
## NULL
## 
## [[28]]
## NULL
## 
## [[29]]
## NULL
## 
## [[30]]
## NULL
## 
## [[31]]
## NULL
## 
## [[32]]
## NULL
## 
## [[33]]
## NULL
## 
## [[34]]
## NULL
## 
## [[35]]
## NULL
## 
## [[36]]
## NULL
## 
## [[37]]
## NULL
## 
## [[38]]
## NULL
## 
## [[39]]
## NULL
## 
## [[40]]
## NULL
## 
## [[41]]
## NULL
## 
## [[42]]
## NULL
## 
## [[43]]
## NULL
## 
## [[44]]
## NULL
## 
## [[45]]
## NULL
## 
## [[46]]
## NULL
## 
## [[47]]
## NULL
## 
## [[48]]
## NULL
## 
## [[49]]
## NULL
## 
## [[50]]
## NULL
## 
## [[51]]
## NULL
plot(apply(Nts, 1, sum)[1:i], xlab=&quot;time&quot;, ylab=&quot;popsize&quot;)</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-28-2.png" width="672" /></p>
<p>Exploring some trajectories of the simulations</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="population-growth-on-multiple-sites.html#cb43-1" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Nts)  <span class="co"># Get the number of rows in Nts</span></span>
<span id="cb43-2"><a href="population-growth-on-multiple-sites.html#cb43-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">apply</span>(Nts[<span class="dv">1</span><span class="sc">:</span>i, sites<span class="sc">$</span>culture<span class="sc">==</span><span class="st">&quot;F&quot;</span>,<span class="at">drop=</span>F], <span class="dv">1</span>, sum), <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb43-3"><a href="population-growth-on-multiple-sites.html#cb43-3" tabindex="-1"></a>     <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(<span class="fu">apply</span>(Nts, <span class="dv">1</span>, sum))))  <span class="co"># Plot sum of &#39;F&#39; culture values</span></span>
<span id="cb43-4"><a href="population-growth-on-multiple-sites.html#cb43-4" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">apply</span>(Nts[<span class="dv">1</span><span class="sc">:</span>i, sites<span class="sc">$</span>culture<span class="sc">==</span><span class="st">&quot;HG&quot;</span>], <span class="dv">1</span>, sum),</span>
<span id="cb43-5"><a href="population-growth-on-multiple-sites.html#cb43-5" tabindex="-1"></a>       <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>)  <span class="co"># Add points for &#39;HG&#39; culture values</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="population-growth-on-multiple-sites.html#cb44-1" tabindex="-1"></a><span class="fu">plot</span>(warcasualties[<span class="dv">1</span><span class="sc">:</span>(i<span class="dv">-1</span>)], <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">type=</span><span class="st">&quot;h&quot;</span>, <span class="at">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>)  <span class="co"># Plot war casualties</span></span>
<span id="cb44-2"><a href="population-growth-on-multiple-sites.html#cb44-2" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">4</span>)  <span class="co"># Add an axis on the right side</span></span>
<span id="cb44-3"><a href="population-growth-on-multiple-sites.html#cb44-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)  <span class="co"># Allow a new plot to be drawn on the existing plot</span></span>
<span id="cb44-4"><a href="population-growth-on-multiple-sites.html#cb44-4" tabindex="-1"></a>growF <span class="ot">&lt;-</span> <span class="fu">apply</span>(Nts[<span class="dv">1</span><span class="sc">:</span>(i<span class="dv">-1</span>), sites<span class="sc">$</span>culture<span class="sc">==</span><span class="st">&quot;F&quot;</span>,<span class="at">drop=</span>F], <span class="dv">1</span>, sum)  <span class="co"># Sum of &#39;F&#39; culture values excluding last row</span></span>
<span id="cb44-5"><a href="population-growth-on-multiple-sites.html#cb44-5" tabindex="-1"></a>growHG <span class="ot">&lt;-</span> <span class="fu">apply</span>(Nts[<span class="dv">1</span><span class="sc">:</span>(i<span class="dv">-1</span>), sites<span class="sc">$</span>culture<span class="sc">==</span><span class="st">&quot;HG&quot;</span>,<span class="at">drop=</span>F], <span class="dv">1</span>, sum)  <span class="co"># Sum of &#39;HG&#39; culture values excluding last row</span></span>
<span id="cb44-6"><a href="population-growth-on-multiple-sites.html#cb44-6" tabindex="-1"></a><span class="fu">plot</span>(growF, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(growF, growHG)))  <span class="co"># Plot growth of &#39;F&#39; culture</span></span>
<span id="cb44-7"><a href="population-growth-on-multiple-sites.html#cb44-7" tabindex="-1"></a><span class="fu">points</span>(growHG, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>)  <span class="co"># Add points for growth of &#39;HG&#39; culture</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-29-2.png" width="672" /></p>
</div>
<div id="manual-selection" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Manually Select Ressources<a href="population-growth-on-multiple-sites.html#manual-selection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Below some useful code to manually select the resource origins on the map (by clicking on the screen) and explore different decays around them</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="population-growth-on-multiple-sites.html#cb45-1" tabindex="-1"></a><span class="fu">plotMap</span>(height.ras, height.wat, <span class="fu">paste0</span>(<span class="st">&quot;year &quot;</span>, <span class="dv">0</span>))</span>
<span id="cb45-2"><a href="population-growth-on-multiple-sites.html#cb45-2" tabindex="-1"></a>new_site <span class="ot">&lt;-</span> <span class="fu">vect</span>(<span class="fu">as.data.frame</span>(<span class="fu">locator</span>()), <span class="at">geom=</span><span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>))  <span class="co"># select point on the sscreep</span></span>
<span id="cb45-3"><a href="population-growth-on-multiple-sites.html#cb45-3" tabindex="-1"></a><span class="fu">crs</span>(new_site) <span class="ot">&lt;-</span> <span class="fu">crs</span>(height.ras)</span>
<span id="cb45-4"><a href="population-growth-on-multiple-sites.html#cb45-4" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">logisticdecay</span>(new_site, height.ras, <span class="at">x=</span><span class="dv">20000</span>) <span class="co"># generate a logistic decay around the point</span></span>
<span id="cb45-5"><a href="population-growth-on-multiple-sites.html#cb45-5" tabindex="-1"></a></span>
<span id="cb45-6"><a href="population-growth-on-multiple-sites.html#cb45-6" tabindex="-1"></a><span class="fu">plot</span>(d2)</span>
<span id="cb45-7"><a href="population-growth-on-multiple-sites.html#cb45-7" tabindex="-1"></a>w <span class="ot">&lt;-</span> (<span class="fl">0.7</span><span class="sc">*</span>d2 <span class="sc">+</span> <span class="fl">0.3</span><span class="sc">*</span>ress) <span class="sc">/</span> (<span class="fl">0.7</span><span class="sc">*</span><span class="fu">minmax</span>(d2)[<span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.3</span><span class="sc">*</span><span class="fu">minmax</span>(ress)[<span class="dv">2</span>])</span>
<span id="cb45-8"><a href="population-growth-on-multiple-sites.html#cb45-8" tabindex="-1"></a><span class="fu">plot</span>(w)</span>
<span id="cb45-9"><a href="population-growth-on-multiple-sites.html#cb45-9" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">mask</span>(w<span class="sc">*</span><span class="fu">logisticdecay</span>(new_site, height.ras, <span class="at">k=</span><span class="fl">0.00002</span>, <span class="at">x=</span><span class="dv">1</span>), territory))</span>
<span id="cb45-10"><a href="population-growth-on-multiple-sites.html#cb45-10" tabindex="-1"></a>multisamp <span class="ot">&lt;-</span> <span class="fu">sapply</span>(</span>
<span id="cb45-11"><a href="population-growth-on-multiple-sites.html#cb45-11" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>,</span>
<span id="cb45-12"><a href="population-growth-on-multiple-sites.html#cb45-12" tabindex="-1"></a>  <span class="cf">function</span>(i){</span>
<span id="cb45-13"><a href="population-growth-on-multiple-sites.html#cb45-13" tabindex="-1"></a>    <span class="fu">spatSample</span>(<span class="at">x=</span>w, <span class="at">size=</span><span class="dv">1</span>, <span class="at">method=</span><span class="st">&quot;weights&quot;</span>, <span class="at">xy=</span>T)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb45-14"><a href="population-growth-on-multiple-sites.html#cb45-14" tabindex="-1"></a>  }</span>
<span id="cb45-15"><a href="population-growth-on-multiple-sites.html#cb45-15" tabindex="-1"></a>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="landscape-climate-environment.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="record-formation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
